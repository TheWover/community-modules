#!/usr/bin/env python3
import subprocess
from subprocess import PIPE, run, STDOUT
from tempfile import mkstemp
import base64

verbose = False
result = []

def vprint(status):
    global result
    result.append(status)
    if verbose:
        print(status)
        
def runHealthInspector():
    encoded = """Ly9BdXRob3IgQ29keSBUaG9tYXMsIEBpdHNfYV9mZWF0dXJlXwovL0FsbCBvZiB0aGVzZSBmdW5jdGlvbnMgdXNlIE9iamVjdGl2ZSBDIEFQSSBjYWxscyB0byByZWFkIFBMSVNUIGZpbGVzIGZyb20gYW4gdW5hdXRoZW50aWNhdGVkIGNvbnRleHQKLy9IZWxwZXIgRnVuY3Rpb25zIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCmZ1bmN0aW9uIGhleDJhKGhleHgpIHsKICAgIGxldCBoZXggPSBoZXh4LnRvU3RyaW5nKCk7Ly9mb3JjZSBjb252ZXJzaW9uCiAgICBsZXQgc3RyID0gJyc7CiAgICBmb3IgKGxldCBpID0gMDsgKGkgPCBoZXgubGVuZ3RoICYmIGhleC5zdWJzdHIoaSwgMikgIT09ICcwMCcpOyBpICs9IDIpCiAgICAgICAgc3RyICs9IFN0cmluZy5mcm9tQ2hhckNvZGUocGFyc2VJbnQoaGV4LnN1YnN0cihpLCAyKSwgMTYpKTsKICAgIHJldHVybiBzdHI7Cn0KZnVuY3Rpb24gZ2V0X3Blcm1pc3Npb25zKHBhdGgpewoJbGV0IGZpbGVNYW5hZ2VyID0gJC5OU0ZpbGVNYW5hZ2VyLmRlZmF1bHRNYW5hZ2VyOwoJYXR0cmlidXRlcyA9IE9iakMuZGVlcFVud3JhcChmaWxlTWFuYWdlci5hdHRyaWJ1dGVzT2ZJdGVtQXRQYXRoRXJyb3IoJChwYXRoKSwgJCgpKSk7CgkvL3JldHVybiBhdHRyaWJ1dGVzOwogICAgbGV0IHRyaW1tZWRfYXR0cmlidXRlcyA9IHt9OwogICAgaWYoYXR0cmlidXRlcyA9PT0gdW5kZWZpbmVkKXsKICAgIAlyZXR1cm4gWyJGYWlsZWQgdG8gZ2V0IHBlcm1pc3Npb25zIl07CiAgICB9CiAgICB0cmltbWVkX2F0dHJpYnV0ZXNbJ05TRmlsZU93bmVyQWNjb3VudElEJ10gPSBhdHRyaWJ1dGVzWydOU0ZpbGVPd25lckFjY291bnRJRCddOwogICAgdHJpbW1lZF9hdHRyaWJ1dGVzWydOU0ZpbGVFeHRlbnNpb25IaWRkZW4nXSA9IGF0dHJpYnV0ZXNbJ05TRmlsZUV4dGVuc2lvbkhpZGRlbiddOwogICAgdHJpbW1lZF9hdHRyaWJ1dGVzWydOU0ZpbGVHcm91cE93bmVyQWNjb3VudElEJ10gPSBhdHRyaWJ1dGVzWydOU0ZpbGVHcm91cE93bmVyQWNjb3VudElEJ107CiAgICB0cmltbWVkX2F0dHJpYnV0ZXNbJ05TRmlsZU93bmVyQWNjb3VudE5hbWUnXSA9IGF0dHJpYnV0ZXNbJ05TRmlsZU93bmVyQWNjb3VudE5hbWUnXTsKICAgIHRyaW1tZWRfYXR0cmlidXRlc1snTlNGaWxlQ3JlYXRpb25EYXRlJ10gPSBhdHRyaWJ1dGVzWydOU0ZpbGVDcmVhdGlvbkRhdGUnXTsKICAgIGxldCBuc3Bvc2l4ID0gYXR0cmlidXRlc1snTlNGaWxlUG9zaXhQZXJtaXNzaW9ucyddOwogICAgLy8gd2UgbmVlZCB0byBmaXggdGhpcyBtZXNzIHRvIGFjdHVhbGx5IGJlIHJlYWwgcGVybWlzc2lvbiBiaXRzIHRoYXQgbWFrZSBzZW5zZQogICAgbGV0IHBvc2l4ID0gKChuc3Bvc2l4ID4+IDYpICYgMHg3KS50b1N0cmluZygpICsgKChuc3Bvc2l4ID4+IDMpICYgMHg3KS50b1N0cmluZygpICsgKG5zcG9zaXggJiAweDcpLnRvU3RyaW5nKCk7CiAgICB0cmltbWVkX2F0dHJpYnV0ZXNbJ05TRmlsZVBvc2l4UGVybWlzc2lvbnMnXSA9IHBvc2l4OwogICAgdHJpbW1lZF9hdHRyaWJ1dGVzWydOU0ZpbGVHcm91cE93bmVyQWNjb3VudE5hbWUnXSA9IGF0dHJpYnV0ZXNbJ05TRmlsZUdyb3VwT3duZXJBY2NvdW50TmFtZSddOwogICAgdHJpbW1lZF9hdHRyaWJ1dGVzWydOU0ZpbGVNb2RpZmljYXRpb25EYXRlJ10gPSBhdHRyaWJ1dGVzWydOU0ZpbGVNb2RpZmljYXRpb25EYXRlJ107CiAgICByZXR1cm4gdHJpbW1lZF9hdHRyaWJ1dGVzOwp9CmZ1bmN0aW9uIGZpbGVfZXhpc3RzKHBhdGgpewoJbGV0IGZpbGVNYW5hZ2VyID0gJC5OU0ZpbGVNYW5hZ2VyLmRlZmF1bHRNYW5hZ2VyOwoJcmV0dXJuIGZpbGVNYW5hZ2VyLmZpbGVFeGlzdHNBdFBhdGgoJChwYXRoKSk7Cn0KLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCmZ1bmN0aW9uIFBlcnNpc3RlbnRfRG9ja19BcHBzKHtoZWxwPWZhbHNlLCBqc29uPWZhbHNlLCB1c2VyPSIifSA9IHt9KXsKCWlmKGhlbHApewoJICAgIGxldCBvdXRwdXQgPSAiIjsKCQlyZXR1cm4gb3V0cHV0OwoJfQoJbGV0IG91dHB1dCA9IHt9OwoJbGV0IGZpbGVNYW5hZ2VyID0gJC5OU0ZpbGVNYW5hZ2VyLmRlZmF1bHRNYW5hZ2VyOwoJbGV0IGN1cnJlbnRVc2VyUGF0aCA9ICIiOyBpZih1c2VyID09PSAiIil7Y3VycmVudFVzZXJQYXRoID0gZmlsZU1hbmFnZXIuaG9tZURpcmVjdG9yeUZvckN1cnJlbnRVc2VyLmZpbGVTeXN0ZW1SZXByZXNlbnRhdGlvbjt9ZWxzZXtjdXJyZW50VXNlclBhdGggPSAiL1VzZXJzLyIgKyB1c2VyO30KCWlmKCFmaWxlX2V4aXN0cyhjdXJyZW50VXNlclBhdGggKyAiL0xpYnJhcnkvUHJlZmVyZW5jZXMvY29tLmFwcGxlLmRvY2sucGxpc3QiKSl7CgkJaWYoanNvbj09ZmFsc2UpewoJCQlyZXR1cm4gIioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqXG4iICsgIioqKiogUGVyc2lzdGVudCBEb2NrIEFwcGxpY2F0aW9ucyAqKioqXG4iICsgIioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqXG4iICsgIlJlcXVpcmVkIGZpbGUgbm90IGZvdW5kIjsKCQl9ZWxzZXsKCQkJcmV0dXJuIEpTT04uc3RyaW5naWZ5KHsiSGVhbHRoSW5zcGVjdG9yQ29tbWFuZCI6ICJQZXJzaXN0ZW50X0RvY2tfQXBwcyJ9KTsKCQl9Cgl9CgoJbGV0IGRpY3QgPSAkLk5TTXV0YWJsZURpY3Rpb25hcnkuYWxsb2MuaW5pdFdpdGhDb250ZW50c09mRmlsZShjdXJyZW50VXNlclBhdGggKyAiL0xpYnJhcnkvUHJlZmVyZW5jZXMvY29tLmFwcGxlLmRvY2sucGxpc3QiKTsKCWxldCBjb250ZW50cyA9IE9iakMuZGVlcFVud3JhcChkaWN0KTsKCW91dHB1dFsncGVyc2lzdGVudC1kb2NrLWFwcHMnXSA9IFtdOwoJZm9yKGxldCBpID0gMDsgaSA8IGNvbnRlbnRzWydwZXJzaXN0ZW50LWFwcHMnXS5sZW5ndGg7IGkrKyl7CgkJb3V0cHV0WydwZXJzaXN0ZW50LWRvY2stYXBwcyddLnB1c2goeyJsYWJlbCI6IGNvbnRlbnRzWydwZXJzaXN0ZW50LWFwcHMnXVtpXVsndGlsZS1kYXRhJ11bJ2ZpbGUtbGFiZWwnXSwKCQkJCQkJCQkJCQkgImJ1bmRsZSI6IGNvbnRlbnRzWydwZXJzaXN0ZW50LWFwcHMnXVtpXVsndGlsZS1kYXRhJ11bJ2J1bmRsZS1pZGVudGlmaWVyJ119KTsKCX0KCWZvcihsZXQgaSA9IDA7IGkgPCBjb250ZW50c1sncGVyc2lzdGVudC1vdGhlcnMnXS5sZW5ndGg7IGkrKyl7CgkJb3V0cHV0WydwZXJzaXN0ZW50LWRvY2stYXBwcyddLnB1c2goeyJsYWJlbCI6IGNvbnRlbnRzWydwZXJzaXN0ZW50LW90aGVycyddW2ldWyd0aWxlLWRhdGEnXVsnZmlsZS1sYWJlbCddLAoJCQkJCQkJCQkJCSAiYnVuZGxlIjogY29udGVudHNbJ3BlcnNpc3RlbnQtb3RoZXJzJ11baV1bJ3RpbGUtZGF0YSddWydidW5kbGUtaWRlbnRpZmllciddfSk7Cgl9CglvdXRwdXRbJ3Nob3ctcmVjZW50cyddID0gY29udGVudHNbJ3Nob3ctcmVjZW50cyddOwoJb3V0cHV0WydyZWNlbnQtYXBwcyddID0gY29udGVudHNbJ3JlY2VudC1hcHBzJ107CglpZihqc29uPT1mYWxzZSl7CgkJb3V0cHV0ID0gIioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqXG4iICsgIioqKiogUGVyc2lzdGVudCBEb2NrIEFwcGxpY2F0aW9ucyAqKioqXG4iICsgIioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqXG4iICsgSlNPTi5zdHJpbmdpZnkob3V0cHV0LCBudWxsICwgMSk7Cgl9IAoJZWxzZXsKCQlvdXRwdXRbJ0hlYWx0aEluc3BlY3RvckNvbW1hbmQnXSA9ICJQZXJzaXN0ZW50X0RvY2tfQXBwcyI7CgkJb3V0cHV0ID0gSlNPTi5zdHJpbmdpZnkob3V0cHV0LCBudWxsLCAxKTsKCX0KCXJldHVybiBvdXRwdXQ7fQpmdW5jdGlvbiBTcGFjZXNfQ2hlY2soe2hlbHA9ZmFsc2UsIGpzb249ZmFsc2UsIHVzZXI9IiJ9ID0ge30pewoJaWYoaGVscCl7CgkJbGV0IG91dHB1dCA9ICIiOwoJCXJldHVybiBvdXRwdXQ7Cgl9CglsZXQgb3V0cHV0ID0ge307CglsZXQgZmlsZU1hbmFnZXIgPSAkLk5TRmlsZU1hbmFnZXIuZGVmYXVsdE1hbmFnZXI7CglsZXQgY3VycmVudFVzZXJQYXRoID0gIiI7IGlmKHVzZXIgPT09ICIiKXtjdXJyZW50VXNlclBhdGggPSBmaWxlTWFuYWdlci5ob21lRGlyZWN0b3J5Rm9yQ3VycmVudFVzZXIuZmlsZVN5c3RlbVJlcHJlc2VudGF0aW9uO31lbHNle2N1cnJlbnRVc2VyUGF0aCA9ICIvVXNlcnMvIiArIHVzZXI7fQoJaWYoIWZpbGVfZXhpc3RzKGN1cnJlbnRVc2VyUGF0aCArICIvTGlicmFyeS9QcmVmZXJlbmNlcy9jb20uYXBwbGUuc3BhY2VzLnBsaXN0IikpewoJCWlmKGpzb249PWZhbHNlKXsKCQkJcmV0dXJuICIqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKlxuIiArICIqKioqKioqKiBEZXNrdG9wcyBJbmZvcm1hdGlvbiAqKioqKioqKlxuIiArICIqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKlxuIiArICJSZXF1aXJlZCBmaWxlIG5vdCBmb3VuZCI7CgkJfWVsc2V7CgkJCXJldHVybiBKU09OLnN0cmluZ2lmeSh7IkhlYWx0aEluc3BlY3RvckNvbW1hbmQiOiAiU3BhY2VzX0NoZWNrIn0pOwoJCX0KCX0KCQoJbGV0IGRpY3QgPSAkLk5TTXV0YWJsZURpY3Rpb25hcnkuYWxsb2MuaW5pdFdpdGhDb250ZW50c09mRmlsZShjdXJyZW50VXNlclBhdGggKyAiL0xpYnJhcnkvUHJlZmVyZW5jZXMvY29tLmFwcGxlLnNwYWNlcy5wbGlzdCIpOwoJbGV0IGNvbnRlbnRzID0gT2JqQy5kZWVwVW53cmFwKGRpY3QpOwoJbGV0IG1vbml0b3JzID0gY29udGVudHNbJ1NwYWNlc0Rpc3BsYXlDb25maWd1cmF0aW9uJ11bJ01hbmFnZW1lbnQgRGF0YSddWydNb25pdG9ycyddOwoJZm9yKGxldCBpID0gMDsgaSA8IG1vbml0b3JzLmxlbmd0aDsgaSsrKXsKCQlpZihtb25pdG9yc1tpXVsnRGlzcGxheSBJZGVudGlmaWVyJ10gPT0gIk1haW4iKXsKCQkJbGV0IGN1cnJlbnRTcGFjZUlEID0gbW9uaXRvcnNbaV1bJ0N1cnJlbnQgU3BhY2UnXVsnTWFuYWdlZFNwYWNlSUQnXTsKCQkJbGV0IGN1cnJlbnRTcGFjZVBsYWNlID0gMDsKCQkJbGV0IHRvdGFsU3BhY2VzID0gbW9uaXRvcnNbaV1bJ1NwYWNlcyddLmxlbmd0aDsKCQkJZm9yKGxldCBqID0gMDsgaiA8IG1vbml0b3JzW2ldWydTcGFjZXMnXS5sZW5ndGg7IGorKyl7CgkJCQlpZihjdXJyZW50U3BhY2VJRCA9PSBtb25pdG9yc1tpXVsnU3BhY2VzJ11bal1bJ01hbmFnZWRTcGFjZUlEJ10pewoJCQkJCWN1cnJlbnRTcGFjZVBsYWNlID0gaiArIDE7CgkJCQl9CgkJCX0KCQkJb3V0cHV0WydNYWluIERlc2t0b3AnXSA9IHt9OwoJCQlvdXRwdXRbJ01haW4gRGVza3RvcCddWydDdXJyZW50IFNwYWNlJ10gPSBjdXJyZW50U3BhY2VQbGFjZTsKCQkJb3V0cHV0WydNYWluIERlc2t0b3AnXVsnVG90YWwgU3BhY2VzJ10gPSB0b3RhbFNwYWNlczsKCQl9Cgl9CglpZihqc29uPT1mYWxzZSl7CgkJb3V0cHV0ID0gIioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqXG4iICsgIioqKioqKioqIERlc2t0b3BzIEluZm9ybWF0aW9uICoqKioqKioqXG4iICsgIioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqXG4iICsgSlNPTi5zdHJpbmdpZnkob3V0cHV0LCBudWxsICwgMSk7Cgl9CgllbHNlewoJCW91dHB1dFsnSGVhbHRoSW5zcGVjdG9yQ29tbWFuZCddID0gIlNwYWNlc19DaGVjayI7CgkJb3V0cHV0ID0gSlNPTi5zdHJpbmdpZnkob3V0cHV0LCBudWxsLCAxKTsKCX0KCQoJcmV0dXJuIG91dHB1dDt9CmZ1bmN0aW9uIEdldF9PZmZpY2VfRW1haWwoe2hlbHA9ZmFsc2UsIGpzb249ZmFsc2UsIHVzZXI9IiJ9ID0ge30pewoJaWYoaGVscCl7CgkJbGV0IG91dHB1dCA9ICIiOwoJCXJldHVybiBvdXRwdXQ7Cgl9CglsZXQgZmlsZU1hbmFnZXIgPSAkLk5TRmlsZU1hbmFnZXIuZGVmYXVsdE1hbmFnZXI7CglsZXQgY3VycmVudFVzZXJQYXRoID0gIiI7IGlmKHVzZXIgPT09ICIiKXtjdXJyZW50VXNlclBhdGggPSBmaWxlTWFuYWdlci5ob21lRGlyZWN0b3J5Rm9yQ3VycmVudFVzZXIuZmlsZVN5c3RlbVJlcHJlc2VudGF0aW9uO31lbHNle2N1cnJlbnRVc2VyUGF0aCA9ICIvVXNlcnMvIiArIHVzZXI7fQoJaWYoIWZpbGVfZXhpc3RzKGN1cnJlbnRVc2VyUGF0aCArICIvTGlicmFyeS9QcmVmZXJlbmNlcy9jb20ubWljcm9zb2Z0Lm9mZmljZS5wbGlzdCIpKXsKCQlpZihqc29uPT1mYWxzZSl7CgkJCXJldHVybiAiKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKipcbiIgKyAiKioqKioqIFJlZ2lzdGVyZWQgT2ZmaWNlIEVtYWlsICoqKioqKlxuIiArICIqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKlxuIiArICJSZXF1aXJlZCBmaWxlIG5vdCBmb3VuZCI7CgkJfWVsc2V7CgkJCXJldHVybiBKU09OLnN0cmluZ2lmeSh7IkhlYWx0aEluc3BlY3RvckNvbW1hbmQiOiAiR2V0X09mZmljZV9FbWFpbCJ9KTsKCQl9Cgl9CglsZXQgZGljdCA9ICQuTlNNdXRhYmxlRGljdGlvbmFyeS5hbGxvYy5pbml0V2l0aENvbnRlbnRzT2ZGaWxlKGN1cnJlbnRVc2VyUGF0aCArICIvTGlicmFyeS9QcmVmZXJlbmNlcy9jb20ubWljcm9zb2Z0Lm9mZmljZS5wbGlzdCIpOwoJbGV0IGNvbnRlbnRzID0gT2JqQy5kZWVwVW53cmFwKGRpY3QpOwoJbGV0IG91dHB1dCA9IHt9OwoJaWYoY29udGVudHMgIT0ge30gJiYgY29udGVudHMgIT0gdW5kZWZpbmVkKXsKCQlvdXRwdXRbJ2VtYWlsJ10gPSBjb250ZW50c1snT2ZmaWNlQWN0aXZhdGlvbkVtYWlsQWRkcmVzcyddOwoJCWlmKGpzb249PWZhbHNlKXsKCQkJb3V0cHV0ID0gIioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqXG4iICsgIioqKioqKiBSZWdpc3RlcmVkIE9mZmljZSBFbWFpbCAqKioqKipcbiIgKyAiKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKipcbiIgKyBKU09OLnN0cmluZ2lmeShvdXRwdXQsIG51bGwgLCAxKTsKCQl9ZWxzZXsKCQkJb3V0cHV0WydIZWFsdGhJbnNwZWN0b3JDb21tYW5kJ10gPSAiR2V0X09mZmljZV9FbWFpbCI7CgkJCW91dHB1dCA9IEpTT04uc3RyaW5naWZ5KG91dHB1dCwgbnVsbCwgMSk7CgkJfQoJfQoJcmV0dXJuIG91dHB1dDt9CmZ1bmN0aW9uIFNhdmVkX1ByaW50ZXJzKHtoZWxwPWZhbHNlLCBqc29uPWZhbHNlLCB1c2VyPSIifSA9IHt9KXsKCWlmKGhlbHApewoJICAgIGxldCBvdXRwdXQgPSAiIjsKCQlyZXR1cm4gb3V0cHV0OwoJfQoJbGV0IG91dHB1dCA9IHt9OwoJbGV0IGZpbGVNYW5hZ2VyID0gJC5OU0ZpbGVNYW5hZ2VyLmRlZmF1bHRNYW5hZ2VyOwoJbGV0IGN1cnJlbnRVc2VyUGF0aCA9ICIiOyBpZih1c2VyID09PSAiIil7Y3VycmVudFVzZXJQYXRoID0gZmlsZU1hbmFnZXIuaG9tZURpcmVjdG9yeUZvckN1cnJlbnRVc2VyLmZpbGVTeXN0ZW1SZXByZXNlbnRhdGlvbjt9ZWxzZXtjdXJyZW50VXNlclBhdGggPSAiL1VzZXJzLyIgKyB1c2VyO30KCWlmKCFmaWxlX2V4aXN0cyhjdXJyZW50VXNlclBhdGggKyAiL0xpYnJhcnkvUHJlZmVyZW5jZXMvb3JnLmN1cHMuUHJpbnRpbmdQcmVmcy5wbGlzdCIpKXsKCQlpZihqc29uPT1mYWxzZSl7CgkJCXJldHVybiAiKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKipcbiIgKyAiKioqKioqKioqIExhc3QgVXNlZCBQcmludGVycyAqKioqKioqKipcbiIgKyAiKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKipcbiIgKyAiUmVxdWlyZWQgZmlsZSBub3QgZm91bmQiOwoJCX1lbHNlewoJCQlyZXR1cm4gSlNPTi5zdHJpbmdpZnkoeyJIZWFsdGhJbnNwZWN0b3JDb21tYW5kIjogIlNhdmVkX1ByaW50ZXJzIn0pOwoJCX0KCX0KCWxldCBkaWN0ID0gJC5OU011dGFibGVEaWN0aW9uYXJ5LmFsbG9jLmluaXRXaXRoQ29udGVudHNPZkZpbGUoY3VycmVudFVzZXJQYXRoICsgIi9MaWJyYXJ5L1ByZWZlcmVuY2VzL29yZy5jdXBzLlByaW50aW5nUHJlZnMucGxpc3QiKTsKCWxldCBjb250ZW50cyA9IE9iakMuZGVlcFVud3JhcChkaWN0KTsKCW91dHB1dFsnTGFzdFVzZWRQcmludGVycyddID0gW107CglpZihjb250ZW50cyAhPSB1bmRlZmluZWQpewoJCWlmKGNvbnRlbnRzLmhhc093blByb3BlcnR5KCdMYXN0VXNlZFByaW50ZXJzJykpewoJCQlmb3IobGV0IGkgPSAwOyBpIDwgY29udGVudHNbJ0xhc3RVc2VkUHJpbnRlcnMnXS5sZW5ndGg7IGkrKyl7CgkJCQlvdXRwdXRbJ0xhc3RVc2VkUHJpbnRlcnMnXS5wdXNoKHsiTmV0d29yayI6IGNvbnRlbnRzWydMYXN0VXNlZFByaW50ZXJzJ11baV1bJ05ldHdvcmsnXSwKCQkJCQkJCQkJCQkJICJQcmludGVySUQiOiBjb250ZW50c1snTGFzdFVzZWRQcmludGVycyddW2ldWydQcmludGVySUQnXX0pOwoJCQl9CgkJfQoJCWlmKGpzb249PWZhbHNlKXsKCQkJb3V0cHV0ID0gIioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqXG4iICsgIioqKioqKioqKiBMYXN0IFVzZWQgUHJpbnRlcnMgKioqKioqKioqXG4iICsgIioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqXG4iICsgSlNPTi5zdHJpbmdpZnkob3V0cHV0LCBudWxsICwgMSk7CgkJfWVsc2V7CgkJCW91dHB1dFsnSGVhbHRoSW5zcGVjdG9yQ29tbWFuZCddID0gIlNhdmVkX1ByaW50ZXJzIjsKCQkJb3V0cHV0ID0gSlNPTi5zdHJpbmdpZnkob3V0cHV0LCBudWxsLCAxKTsKCQl9Cgl9CQoJcmV0dXJuIG91dHB1dDt9CmZ1bmN0aW9uIEZpbmRlcl9QcmVmZXJlbmNlcyh7aGVscD1mYWxzZSwganNvbj1mYWxzZSwgdXNlcj0iIn0gPSB7fSl7CglpZihoZWxwKXsKCSAgICBsZXQgb3V0cHV0ID0gIiI7CgkJcmV0dXJuIG91dHB1dDsKCX0KCWxldCBvdXRwdXQgPSB7fTsKCWxldCBmaWxlTWFuYWdlciA9ICQuTlNGaWxlTWFuYWdlci5kZWZhdWx0TWFuYWdlcjsKCWxldCBjdXJyZW50VXNlclBhdGggPSAiIjsgaWYodXNlciA9PT0gIiIpe2N1cnJlbnRVc2VyUGF0aCA9IGZpbGVNYW5hZ2VyLmhvbWVEaXJlY3RvcnlGb3JDdXJyZW50VXNlci5maWxlU3lzdGVtUmVwcmVzZW50YXRpb247fWVsc2V7Y3VycmVudFVzZXJQYXRoID0gIi9Vc2Vycy8iICsgdXNlcjt9CglpZighZmlsZV9leGlzdHMoY3VycmVudFVzZXJQYXRoICsgIi9MaWJyYXJ5L1ByZWZlcmVuY2VzL2NvbS5hcHBsZS5maW5kZXIucGxpc3QiKSl7CgkJaWYoanNvbj09ZmFsc2UpewoJCQlyZXR1cm4gIioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqXG4iICsgIioqIFJlY2VudCBGb2xkZXJzIGFuZCBGaW5kZXIgUHJlZnMgKipcbiIgKyAiKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKipcbiIgKyAiUmVxdWlyZWQgZmlsZSBub3QgZm91bmQiOwoJCX1lbHNlewoJCQlyZXR1cm4gSlNPTi5zdHJpbmdpZnkoeyJIZWFsdGhJbnNwZWN0b3JDb21tYW5kIjogIkZpbmRlcl9QcmVmZXJlbmNlcyJ9KTsKCQl9Cgl9CglsZXQgZGljdCA9ICQuTlNNdXRhYmxlRGljdGlvbmFyeS5hbGxvYy5pbml0V2l0aENvbnRlbnRzT2ZGaWxlKGN1cnJlbnRVc2VyUGF0aCArICIvTGlicmFyeS9QcmVmZXJlbmNlcy9jb20uYXBwbGUuZmluZGVyLnBsaXN0Iik7CglsZXQgY29udGVudHMgPSBPYmpDLmRlZXBVbndyYXAoZGljdCk7CglvdXRwdXRbJ1JlY2VudCBNb3ZlIGFuZCBDb3B5IERlc3RpbmF0aW9ucyddID0gY29udGVudHNbJ1JlY2VudE1vdmVBbmRDb3B5RGVzdGluYXRpb25zJ107CglvdXRwdXRbJ0ZpbmRlciBHb1RvIEZvbGRlciBSZWNlbnRzJ10gPSBjb250ZW50c1snR29Ub0ZpZWxkSGlzdG9yeSddOwoJb3V0cHV0WydTaG93IEFsbCBGaWxlcyBpbiBGaW5kZXInXSA9IGNvbnRlbnRzWydBcHBsZVNob3dBbGxGaWxlcyddOwoJb3V0cHV0WydTaG93IFJlbW92YWJsZSBNZWRpYSBvbiBEZXNrdG9wJ10gPSBjb250ZW50c1snU2hvd1JlbW92YWJsZU1lZGlhT25EZXNrdG9wJ107CglvdXRwdXRbJ1RhZyBOYW1lcyddID0gY29udGVudHNbJ0Zhdm9yaXRlVGFnTmFtZXMnXTsKCW91dHB1dFsnUmVjZW50IEZvbGRlcnMnXSA9IFtdOwoJaWYoJ0ZYUmVjZW50Rm9sZGVycycgaW4gY29udGVudHMpewoJCWZvcihsZXQgaSA9IDA7IGkgPCBjb250ZW50c1snRlhSZWNlbnRGb2xkZXJzJ10ubGVuZ3RoOyBpKyspewoJCQlvdXRwdXRbJ1JlY2VudCBGb2xkZXJzJ10ucHVzaChjb250ZW50c1snRlhSZWNlbnRGb2xkZXJzJ11baV1bJ25hbWUnXSk7CgkJfQoJfQoJaWYoJ0ZYRGVza3RvcFZvbHVtZVBvc2l0aW9ucycgaW4gY29udGVudHMpewoJCW91dHB1dFsnUHJpb3IgTW91bnRlZCBWb2x1bWVzJ10gPSBPYmplY3Qua2V5cyhjb250ZW50c1snRlhEZXNrdG9wVm9sdW1lUG9zaXRpb25zJ10pOwoJfQoJaWYoanNvbj09ZmFsc2UpewoJCW91dHB1dCA9ICIqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKlxuIiArICIqKiBSZWNlbnQgRm9sZGVycyBhbmQgRmluZGVyIFByZWZzICoqXG4iICsgIioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqXG4iICsgSlNPTi5zdHJpbmdpZnkob3V0cHV0LCBudWxsICwgMSk7Cgl9ZWxzZXsKCQlvdXRwdXRbJ0hlYWx0aEluc3BlY3RvckNvbW1hbmQnXSA9ICJGaW5kZXJfUHJlZmVyZW5jZXMiOwoJCW91dHB1dCA9IEpTT04uc3RyaW5naWZ5KG91dHB1dCwgbnVsbCwgMSk7Cgl9CgkKCXJldHVybiBvdXRwdXQ7fQpmdW5jdGlvbiBMYXVuY2hfU2VydmljZXMoe2hlbHA9ZmFsc2UsIGpzb249ZmFsc2UsIHVzZXI9IiJ9ID0ge30pewoJaWYoaGVscCl7CgkgICAgbGV0IG91dHB1dCA9ICIiOwoJCXJldHVybiBvdXRwdXQ7Cgl9CglsZXQgb3V0cHV0ID0ge307CglsZXQgZmlsZU1hbmFnZXIgPSAkLk5TRmlsZU1hbmFnZXIuZGVmYXVsdE1hbmFnZXI7CglsZXQgY3VycmVudFVzZXJQYXRoID0gIiI7IGlmKHVzZXIgPT09ICIiKXtjdXJyZW50VXNlclBhdGggPSBmaWxlTWFuYWdlci5ob21lRGlyZWN0b3J5Rm9yQ3VycmVudFVzZXIuZmlsZVN5c3RlbVJlcHJlc2VudGF0aW9uO31lbHNle2N1cnJlbnRVc2VyUGF0aCA9ICIvVXNlcnMvIiArIHVzZXI7fQoJaWYoIWZpbGVfZXhpc3RzKGN1cnJlbnRVc2VyUGF0aCArICIvTGlicmFyeS9QcmVmZXJlbmNlcy9jb20uYXBwbGUuTGF1bmNoU2VydmljZXMvY29tLmFwcGxlLmxhdW5jaHNlcnZpY2VzLnNlY3VyZS5wbGlzdCIpKXsKCQlpZihqc29uPT1mYWxzZSl7CgkJCXJldHVybiAiKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKipcbiIgKyAiKioqIEN1c3RvbSBMYXVuY2hTZXJ2aWNlcyBIYW5kbGVycyAqKipcbiIgKyAiKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKipcbiIgKyAiUmVxdWlyZWQgZmlsZSBub3QgZm91bmQiOwoJCX1lbHNlewoJCQlyZXR1cm4gSlNPTi5zdHJpbmdpZnkoeyJIZWFsdGhJbnNwZWN0b3JDb21tYW5kIjogIkxhdW5jaF9TZXJ2aWNlcyJ9KTsKCQl9Cgl9CglsZXQgZGljdCA9ICQuTlNNdXRhYmxlRGljdGlvbmFyeS5hbGxvYy5pbml0V2l0aENvbnRlbnRzT2ZGaWxlKGN1cnJlbnRVc2VyUGF0aCArICIvTGlicmFyeS9QcmVmZXJlbmNlcy9jb20uYXBwbGUuTGF1bmNoU2VydmljZXMvY29tLmFwcGxlLmxhdW5jaHNlcnZpY2VzLnNlY3VyZS5wbGlzdCIpOwoJbGV0IGNvbnRlbnRzID0gT2JqQy5kZWVwVW53cmFwKGRpY3QpOwoJb3V0cHV0WydMU0hhbmRsZXJzX0ZpbGVFeHRlbnNpb25zJ10gPSBbXTsKCW91dHB1dFsnTFNIYW5kbGVyc19VUkxTY2hlbWVzJ10gPSBbXTsKCWlmKGNvbnRlbnRzICE9IHVuZGVmaW5lZCl7CgkJZm9yKGxldCBpID0gMDsgaSA8IGNvbnRlbnRzWydMU0hhbmRsZXJzJ10ubGVuZ3RoOyBpKyspewoJCQlpZihjb250ZW50c1snTFNIYW5kbGVycyddW2ldLmhhc093blByb3BlcnR5KCdMU0hhbmRsZXJDb250ZW50VGFnJykpewoJCQkJb3V0cHV0WydMU0hhbmRsZXJzX0ZpbGVFeHRlbnNpb25zJ10ucHVzaCh7ImZpbGVfZXh0ZW5zaW9uIjogY29udGVudHNbJ0xTSGFuZGxlcnMnXVtpXVsnTFNIYW5kbGVyQ29udGVudFRhZyddLAoJCQkJCQkJCQkJCQkJCSAgImhhbmRsZXIiOiBjb250ZW50c1snTFNIYW5kbGVycyddW2ldWydMU0hhbmRsZXJSb2xlQWxsJ119KTsKCQkJfQoJCQllbHNlIGlmKGNvbnRlbnRzWydMU0hhbmRsZXJzJ11baV0uaGFzT3duUHJvcGVydHkoJ0xTSGFuZGxlclVSTFNjaGVtZScpKXsKCQkJCW91dHB1dFsnTFNIYW5kbGVyc19VUkxTY2hlbWVzJ10ucHVzaCh7IlVSTFNjaGVtZSI6IGNvbnRlbnRzWydMU0hhbmRsZXJzJ11baV1bJ0xTSGFuZGxlclVSTFNjaGVtZSddLAoJCQkJCQkJCQkJCQkJCSAgImhhbmRsZXIiOiBjb250ZW50c1snTFNIYW5kbGVycyddW2ldWydMU0hhbmRsZXJSb2xlQWxsJ10sCgkJCQkJCQkJCQkJCQkJICAidmlld2VyIjogY29udGVudHNbJ0xTSGFuZGxlcnMnXVtpXVsnTFNIYW5kbGVyUm9sZVZpZXdlciddfSk7CgkJCX0KCQkJZWxzZXsKCQkJCW91dHB1dFsnTFNIYW5kbGVyc19VUkxTY2hlbWVzJ10ucHVzaCh7IkNvbnRlbnRUeXBlIjogY29udGVudHNbJ0xTSGFuZGxlcnMnXVtpXVsnTFNIYW5kbGVyQ29udGVudFR5cGUnXSwKCQkJCQkJCQkJCQkJCQkgICJoYW5kbGVyIjogY29udGVudHNbJ0xTSGFuZGxlcnMnXVtpXVsnTFNIYW5kbGVyUm9sZUFsbCddLAoJCQkJCQkJCQkJCQkJCSJ2aWV3ZXIiOiBjb250ZW50c1snTFNIYW5kbGVycyddW2ldWydMU0hhbmRsZXJSb2xlVmlld2VyJ119KTsKCQkJfQoJCX0KCX0KCWlmKGpzb249PWZhbHNlKXsKCQlvdXRwdXQgPSAiKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKipcbiIgKyAiKioqIEN1c3RvbSBMYXVuY2hTZXJ2aWNlcyBIYW5kbGVycyAqKipcbiIgKyAiKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKipcbiIgKyBKU09OLnN0cmluZ2lmeShvdXRwdXQsIG51bGwgLCAxKTsKCX1lbHNlewoJCW91dHB1dFsnSGVhbHRoSW5zcGVjdG9yQ29tbWFuZCddID0gIkxhdW5jaF9TZXJ2aWNlcyI7CgkJb3V0cHV0ID0gSlNPTi5zdHJpbmdpZnkob3V0cHV0LCBudWxsLCAxKTsKCX0KCXJldHVybiBvdXRwdXQ7fQpmdW5jdGlvbiBVbml2ZXJzYWxfQWNjZXNzX0F1dGhfV2FybmluZyh7aGVscD1mYWxzZSwganNvbj1mYWxzZSwgdXNlcj0iIn0gPSB7fSl7CgkvLyBpbmZvcm1hdGlvbiBvbiBhbGwgYXBwcyB0aGF0IG1hY09TIGhhcyBldmVyIHRocm93biB0aGUg4oCYc29tZS5hcHAgd291bGQgbGlrZSBwZXJtaXNzaW9uIHRvIGNvbnRyb2wgeW91ciBjb21wdXRlcgoJaWYoaGVscCl7CgkgICAgbGV0IG91dHB1dCA9ICIiOwoJCXJldHVybiBvdXRwdXQ7Cgl9CglsZXQgb3V0cHV0ID0ge307CglsZXQgZmlsZU1hbmFnZXIgPSAkLk5TRmlsZU1hbmFnZXIuZGVmYXVsdE1hbmFnZXI7CglsZXQgY3VycmVudFVzZXJQYXRoID0gIiI7IGlmKHVzZXIgPT09ICIiKXtjdXJyZW50VXNlclBhdGggPSBmaWxlTWFuYWdlci5ob21lRGlyZWN0b3J5Rm9yQ3VycmVudFVzZXIuZmlsZVN5c3RlbVJlcHJlc2VudGF0aW9uO31lbHNle2N1cnJlbnRVc2VyUGF0aCA9ICIvVXNlcnMvIiArIHVzZXI7fQoJaWYoIWZpbGVfZXhpc3RzKGN1cnJlbnRVc2VyUGF0aCArICIvTGlicmFyeS9QcmVmZXJlbmNlcy9jb20uYXBwbGUudW5pdmVyc2FsYWNjZXNzQXV0aFdhcm5pbmcucGxpc3QiKSl7CgkJaWYoanNvbj09ZmFsc2UpewoJCQlyZXR1cm4gIioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqXG4iICsgIioqKiogVW5pdmVyc2FsQWNjZXNzIEF1dGggV2FybmluZyAqKioqXG4iICsgIioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqXG4iICsgIlJlcXVpcmVkIGZpbGUgbm90IGZvdW5kIjsKCQl9ZWxzZXsKCQkJcmV0dXJuIEpTT04uc3RyaW5naWZ5KHsiSGVhbHRoSW5zcGVjdG9yQ29tbWFuZCI6ICJVbml2ZXJzYWxfQWNjZXNzX0F1dGhfV2FybmluZyJ9KTsKCQl9Cgl9CglsZXQgZGljdCA9ICQuTlNNdXRhYmxlRGljdGlvbmFyeS5hbGxvYy5pbml0V2l0aENvbnRlbnRzT2ZGaWxlKGN1cnJlbnRVc2VyUGF0aCArICIvTGlicmFyeS9QcmVmZXJlbmNlcy9jb20uYXBwbGUudW5pdmVyc2FsYWNjZXNzQXV0aFdhcm5pbmcucGxpc3QiKTsKCWxldCBjb250ZW50cyA9IE9iakMuZGVlcFVud3JhcChkaWN0KTsKCWlmKGNvbnRlbnRzICE9IHt9KXsKCQlvdXRwdXRbJ1VuaXZlcnNhbCBBY2Nlc3MgQXV0aCBXYXJuaW5nIEFwcGxpY2F0aW9ucyddID0gY29udGVudHM7Cgl9CglpZihqc29uPT1mYWxzZSl7CgkJb3V0cHV0ID0gIioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqXG4iICsgIioqKiogVW5pdmVyc2FsQWNjZXNzIEF1dGggV2FybmluZyAqKioqXG4iICsgIioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqXG4iICsgSlNPTi5zdHJpbmdpZnkob3V0cHV0LCBudWxsICwgMSk7Cgl9ZWxzZXsKCQlvdXRwdXRbJ0hlYWx0aEluc3BlY3RvckNvbW1hbmQnXSA9ICJVbml2ZXJzYWxfQWNjZXNzX0F1dGhfV2FybmluZyI7CgkJb3V0cHV0ID0gSlNPTi5zdHJpbmdpZnkob3V0cHV0LCBudWxsLCAxKTsKCX0KCXJldHVybiBvdXRwdXQ7fQpmdW5jdGlvbiBSZWxhdW5jaF9BdF9Mb2dpbih7aGVscD1mYWxzZSwganNvbj1mYWxzZSwgdXNlcj0iIn0gPSB7fSl7CglpZihoZWxwKXsKCSAgICBsZXQgb3V0cHV0ID0gIiI7CgkJcmV0dXJuIG91dHB1dDsKCX0KCWxldCBvdXRwdXQgPSB7fTsKCWxldCBmaWxlTWFuYWdlciA9ICQuTlNGaWxlTWFuYWdlci5kZWZhdWx0TWFuYWdlcjsKCWxldCBjdXJyZW50VXNlclBhdGggPSAiIjsgaWYodXNlciA9PT0gIiIpe2N1cnJlbnRVc2VyUGF0aCA9IGZpbGVNYW5hZ2VyLmhvbWVEaXJlY3RvcnlGb3JDdXJyZW50VXNlci5maWxlU3lzdGVtUmVwcmVzZW50YXRpb247fWVsc2V7Y3VycmVudFVzZXJQYXRoID0gIi9Vc2Vycy8iICsgdXNlcjt9CglsZXQgZmlsZXMgPSBPYmpDLmRlZXBVbndyYXAoZmlsZU1hbmFnZXIuY29udGVudHNPZkRpcmVjdG9yeUF0UGF0aEVycm9yKGN1cnJlbnRVc2VyUGF0aCArICIvTGlicmFyeS9QcmVmZXJlbmNlcy9CeUhvc3QiLCBSZWYoKSkpOwoJb3V0cHV0WydSZWxhdW5jaCBBcHBzJ10gPSBbXTsKCWZvcihpIGluIGZpbGVzKXsKCQlpZihmaWxlc1tpXS5pbmNsdWRlcygiY29tLmFwcGxlLmxvZ2lud2luZG93IikgJiYgZmlsZXNbaV0uZW5kc1dpdGgoIi5wbGlzdCIpKXsKCQkJbGV0IGRpY3QgPSAkLk5TTXV0YWJsZURpY3Rpb25hcnkuYWxsb2MuaW5pdFdpdGhDb250ZW50c09mRmlsZShjdXJyZW50VXNlclBhdGggKyAiL0xpYnJhcnkvUHJlZmVyZW5jZXMvQnlIb3N0LyIgKyBmaWxlc1tpXSk7CgkJCW91dHB1dFsnUmVsYXVuY2ggQXBwcyddID0gT2JqQy5kZWVwVW53cmFwKGRpY3QpWydUQUxBcHBzVG9SZWxhdW5jaEF0TG9naW4nXTsKCQkJYnJlYWs7CgkJfQoJfQoJaWYoanNvbj09ZmFsc2UpewoJCW91dHB1dCA9ICIqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKlxuIiArICIqIEFwcGxpY2F0aW9ucyB0byBSZWxhdW5jaCBhdCBMb2dpbiAqXG4iICsgIioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqXG4iICsgSlNPTi5zdHJpbmdpZnkob3V0cHV0LCBudWxsICwgMSk7Cgl9ZWxzZXsKCQlvdXRwdXRbJ0hlYWx0aEluc3BlY3RvckNvbW1hbmQnXSA9ICJSZWxhdW5jaF9BdF9Mb2dpbiI7CgkJb3V0cHV0ID0gSlNPTi5zdHJpbmdpZnkob3V0cHV0LCBudWxsLCAxKTsKCX0KCXJldHVybiBvdXRwdXQ7fQpmdW5jdGlvbiBMb2dpbl9JdGVtcyh7aGVscD1mYWxzZSwganNvbj1mYWxzZSwgdXNlcj0iIn0gPSB7fSl7CglpZihoZWxwKXsKCSAgICBsZXQgb3V0cHV0ID0gIiI7CgkJcmV0dXJuIG91dHB1dDsKCX0KCWxldCBvdXRwdXQgPSB7fTsKCWxldCBmaWxlTWFuYWdlciA9ICQuTlNGaWxlTWFuYWdlci5kZWZhdWx0TWFuYWdlcjsKCWxldCBjdXJyZW50VXNlclBhdGggPSAiIjsgaWYodXNlciA9PT0gIiIpe2N1cnJlbnRVc2VyUGF0aCA9IGZpbGVNYW5hZ2VyLmhvbWVEaXJlY3RvcnlGb3JDdXJyZW50VXNlci5maWxlU3lzdGVtUmVwcmVzZW50YXRpb247fWVsc2V7Y3VycmVudFVzZXJQYXRoID0gIi9Vc2Vycy8iICsgdXNlcjt9CglpZighZmlsZV9leGlzdHMoY3VycmVudFVzZXJQYXRoICsgIi9MaWJyYXJ5L1ByZWZlcmVuY2VzL2NvbS5hcHBsZS5sb2dpbml0ZW1zLnBsaXN0IikpewoJCWlmKGpzb249PWZhbHNlKXsKCQkJcmV0dXJuICIqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKlxuIiArICIqKioqKioqKioqKiogTG9naW4gSXRlbXMgKioqKioqKioqKioqXG4iICsgIioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqXG4iICsgIlJlcXVpcmVkIGZpbGUgbm90IGZvdW5kIjsKCQl9ZWxzZXsKCQkJcmV0dXJuIEpTT04uc3RyaW5naWZ5KHsiSGVhbHRoSW5zcGVjdG9yQ29tbWFuZCI6ICJMb2dpbl9JdGVtcyJ9KTsKCQl9Cgl9CglsZXQgZGljdCA9ICQuTlNNdXRhYmxlRGljdGlvbmFyeS5hbGxvYy5pbml0V2l0aENvbnRlbnRzT2ZGaWxlKGN1cnJlbnRVc2VyUGF0aCArICIvTGlicmFyeS9QcmVmZXJlbmNlcy9jb20uYXBwbGUubG9naW5pdGVtcy5wbGlzdCIpOwoJbGV0IGNvbnRlbnRzID0gT2JqQy5kZWVwVW53cmFwKGRpY3QpOwoJaWYoY29udGVudHMgIT0ge30pewoJCW91dHB1dFsnTG9naW5fSXRlbXMnXSA9IGNvbnRlbnRzOwoJfQoJaWYoanNvbj09ZmFsc2UpewoJCW91dHB1dCA9ICIqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKlxuIiArICIqKioqKioqKioqKiogTG9naW4gSXRlbXMgKioqKioqKioqKioqXG4iICsgIioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqXG4iICsgSlNPTi5zdHJpbmdpZnkob3V0cHV0LCBudWxsICwgMSk7Cgl9ZWxzZXsKCQlvdXRwdXRbJ0hlYWx0aEluc3BlY3RvckNvbW1hbmQnXSA9ICJMb2dpbl9JdGVtcyI7CgkJb3V0cHV0ID0gSlNPTi5zdHJpbmdpZnkob3V0cHV0LCBudWxsLCAxKTsKCX0KCXJldHVybiBvdXRwdXQ7fQpmdW5jdGlvbiBVc2VyX0Rpcl9IaWRkZW5fRmlsZXNfRm9sZGVycyh7aGVscD1mYWxzZSwganNvbj1mYWxzZSwgdXNlcj0iIn0gPSB7fSl7CglpZihoZWxwKXsKCSAgICBsZXQgb3V0cHV0ID0gIiI7CgkJcmV0dXJuIG91dHB1dDsKCX0KCWxldCBvdXRwdXQgPSBbXTsKCWxldCBmaWxlTWFuYWdlciA9ICQuTlNGaWxlTWFuYWdlci5kZWZhdWx0TWFuYWdlcjsKCWxldCBjdXJyZW50VXNlclBhdGggPSAiIjsgaWYodXNlciA9PT0gIiIpe2N1cnJlbnRVc2VyUGF0aCA9IGZpbGVNYW5hZ2VyLmhvbWVEaXJlY3RvcnlGb3JDdXJyZW50VXNlci5maWxlU3lzdGVtUmVwcmVzZW50YXRpb247fWVsc2V7Y3VycmVudFVzZXJQYXRoID0gIi9Vc2Vycy8iICsgdXNlcjt9CglsZXQgZmlsZXMgPSBPYmpDLmRlZXBVbndyYXAoZmlsZU1hbmFnZXIuY29udGVudHNPZkRpcmVjdG9yeUF0UGF0aEVycm9yKGN1cnJlbnRVc2VyUGF0aCwgUmVmKCkpKTsKCWZvcihpIGluIGZpbGVzKXsKCQlpZihmaWxlc1tpXVswXSA9PSAiLiIpewoJCQlvdXRwdXQucHVzaChmaWxlc1tpXSk7CgkJfQoJfQoJaWYoanNvbj09ZmFsc2UpewoJCW91dHB1dCA9ICIqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKlxuIiArICIqKioqKiBIaWRkZW4gRmlsZXMvRm9sZGVycyBpbiB+ICoqKioqXG4iICsgIioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqXG4iICsgSlNPTi5zdHJpbmdpZnkob3V0cHV0LCBudWxsICwgMSk7Cgl9ZWxzZXsKCQlvdXRwdXRbJ0hlYWx0aEluc3BlY3RvckNvbW1hbmQnXSA9ICJVc2VyX0Rpcl9IaWRkZW5fRmlsZXNfRm9sZGVycyI7CgkJb3V0cHV0ID0gSlNPTi5zdHJpbmdpZnkob3V0cHV0LCBudWxsLCAxKTsKCX0KCXJldHVybiBvdXRwdXQ7fQpmdW5jdGlvbiBVc2VyX0dsb2JhbF9QcmVmZXJlbmNlcyh7aGVscD1mYWxzZSwganNvbj1mYWxzZSwgdXNlcj0iIn0gPSB7fSl7CglpZihoZWxwKXsKCSAgICBsZXQgb3V0cHV0ID0gIiI7CgkJcmV0dXJuIG91dHB1dDsKCX0KCWxldCBvdXRwdXQgPSB7fTsKCWxldCBmaWxlTWFuYWdlciA9ICQuTlNGaWxlTWFuYWdlci5kZWZhdWx0TWFuYWdlcjsKCWxldCBjdXJyZW50VXNlclBhdGggPSAiIjsgaWYodXNlciA9PT0gIiIpe2N1cnJlbnRVc2VyUGF0aCA9IGZpbGVNYW5hZ2VyLmhvbWVEaXJlY3RvcnlGb3JDdXJyZW50VXNlci5maWxlU3lzdGVtUmVwcmVzZW50YXRpb247fWVsc2V7Y3VycmVudFVzZXJQYXRoID0gIi9Vc2Vycy8iICsgdXNlcjt9CglpZighZmlsZV9leGlzdHMoY3VycmVudFVzZXJQYXRoICsgIi9MaWJyYXJ5L1ByZWZlcmVuY2VzLy5HbG9iYWxQcmVmZXJlbmNlcy5wbGlzdCIpKXsKCQlpZihqc29uPT1mYWxzZSl7CgkJCXJldHVybiAiKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKipcbiIgKyAiKioqKiogVXNlcidzIEdsb2JhbCBQcmVmZXJlbmNlcyAqKioqKlxuIiArICIqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKlxuIiArICJSZXF1aXJlZCBmaWxlIG5vdCBmb3VuZCI7CgkJfWVsc2V7CgkJCXJldHVybiBKU09OLnN0cmluZ2lmeSh7IkhlYWx0aEluc3BlY3RvckNvbW1hbmQiOiAiVXNlcl9HbG9iYWxfUHJlZmVyZW5jZXMifSk7CgkJfQoJfQoJbGV0IGRpY3QgPSAkLk5TTXV0YWJsZURpY3Rpb25hcnkuYWxsb2MuaW5pdFdpdGhDb250ZW50c09mRmlsZShjdXJyZW50VXNlclBhdGggKyAiL0xpYnJhcnkvUHJlZmVyZW5jZXMvLkdsb2JhbFByZWZlcmVuY2VzLnBsaXN0Iik7CglsZXQgY29udGVudHMgPSBPYmpDLmRlZXBVbndyYXAoZGljdCk7CglpZihjb250ZW50c1snTlNQcmVmZXJyZWRXZWJTZXJ2aWNlcyddICE9PSB1bmRlZmluZWQpewoJCW91dHB1dFsnRGVmYXVsdCBXZWIgU2VydmljZSddID0gY29udGVudHNbJ05TUHJlZmVycmVkV2ViU2VydmljZXMnXVsnTlNXZWJTZXJ2aWNlc1Byb3ZpZGVyV2ViU2VhcmNoJ11bJ05TRGVmYXVsdERpc3BsYXlOYW1lJ10gKyAiIC0gIiArIGNvbnRlbnRzWydOU1ByZWZlcnJlZFdlYlNlcnZpY2VzJ11bJ05TV2ViU2VydmljZXNQcm92aWRlcldlYlNlYXJjaCddWydOU1Byb3ZpZGVySWRlbnRpZmllciddCQoJfQoJb3V0cHV0WydSZWNlbnQgUGxhY2VzJ10gPSBjb250ZW50c1snTlNOYXZSZWNlbnRQbGFjZXMnXTsKCWlmKGNvbnRlbnRzWydjb20uYXBwbGUuZmluZGVyLlN5bmNFeHRlbnNpb25zJ10gIT09IHVuZGVmaW5lZCl7CQoJCW91dHB1dFsnRmluZGVyIFN5bmMgRXh0ZW5zaW9ucyddID0gT2JqZWN0LmtleXMoY29udGVudHNbJ2NvbS5hcHBsZS5maW5kZXIuU3luY0V4dGVuc2lvbnMnXVsnZGlyTWFwJ10pOwoJfQoJb3V0cHV0WydTaG93IEFsbCBFeHRlbnNpb25zJ10gPSBjb250ZW50c1snQXBwbGVTaG93QWxsRXh0ZW5zaW9ucyddOwoJaWYoanNvbj09ZmFsc2UpewoJCW91dHB1dCA9ICIqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKlxuIiArICIqKioqKiBVc2VyJ3MgR2xvYmFsIFByZWZlcmVuY2VzICoqKioqXG4iICsgIioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqXG4iICsgSlNPTi5zdHJpbmdpZnkob3V0cHV0LCBudWxsICwgMSk7Cgl9ZWxzZXsKCQlvdXRwdXRbJ0hlYWx0aEluc3BlY3RvckNvbW1hbmQnXSA9ICJVc2VyX0dsb2JhbF9QcmVmZXJlbmNlcyI7CgkJb3V0cHV0ID0gSlNPTi5zdHJpbmdpZnkob3V0cHV0LCBudWxsLCAxKTsKCX0KCXJldHVybiBvdXRwdXQ7fQpmdW5jdGlvbiBVc2VyX0xhdW5jaGFnZW50cyh7aGVscD1mYWxzZSwganNvbj1mYWxzZSwgdXNlcj0iIn0gPSB7fSl7CglpZihoZWxwKXsKCSAgICBsZXQgb3V0cHV0ID0gIiI7CgkJcmV0dXJuIG91dHB1dDsKCX0KCWxldCBvdXRwdXQgPSB7fTsKCWxldCBmaWxlTWFuYWdlciA9ICQuTlNGaWxlTWFuYWdlci5kZWZhdWx0TWFuYWdlcjsKCWxldCBjdXJyZW50VXNlclBhdGggPSAiIjsgaWYodXNlciA9PT0gIiIpe2N1cnJlbnRVc2VyUGF0aCA9IGZpbGVNYW5hZ2VyLmhvbWVEaXJlY3RvcnlGb3JDdXJyZW50VXNlci5maWxlU3lzdGVtUmVwcmVzZW50YXRpb247fWVsc2V7Y3VycmVudFVzZXJQYXRoID0gIi9Vc2Vycy8iICsgdXNlcjt9CglsZXQgZmlsZXMgPSBPYmpDLmRlZXBVbndyYXAoZmlsZU1hbmFnZXIuY29udGVudHNPZkRpcmVjdG9yeUF0UGF0aEVycm9yKGN1cnJlbnRVc2VyUGF0aCArICIvTGlicmFyeS9MYXVuY2hBZ2VudHMvIiwgUmVmKCkpKTsKCWZvcihpIGluIGZpbGVzKXsKCQlsZXQgZGljdCA9ICQuTlNNdXRhYmxlRGljdGlvbmFyeS5hbGxvYy5pbml0V2l0aENvbnRlbnRzT2ZGaWxlKGN1cnJlbnRVc2VyUGF0aCArICIvTGlicmFyeS9MYXVuY2hBZ2VudHMvIiArIGZpbGVzW2ldKTsKCQlkaWN0ID0gT2JqQy5kZWVwVW53cmFwKGRpY3QpOwoJCWlmKGRpY3QgIT09IHVuZGVmaW5lZCAmJiBkaWN0Lmhhc093blByb3BlcnR5KCdQcm9ncmFtQXJndW1lbnRzJykpewogICAgICAgICAgICBkaWN0WydQcm9ncmFtIEF0dHJpYnV0ZXMnXSA9IGdldF9wZXJtaXNzaW9ucyhkaWN0WydQcm9ncmFtQXJndW1lbnRzJ11bMF0pOwogICAgICAgICAgICBwcm9ncmFtX2RpciA9IGRpY3RbJ1Byb2dyYW1Bcmd1bWVudHMnXVswXS5zcGxpdCgiLyIpOwogICAgICAgICAgICBwcm9ncmFtX2Rpci5wb3AoKTsKICAgICAgICAgICAgcHJvZ3JhbV9kaXIgPSAiLyIgKyBwcm9ncmFtX2Rpci5qb2luKCIvIik7CiAgICAgICAgICAgIGRpY3RbJ1Byb2dyYW0gRGlyZWN0b3J5IEF0dHJpYnV0ZXMnXSA9IGdldF9wZXJtaXNzaW9ucyhwcm9ncmFtX2Rpcik7CgkJfQoJCWVsc2UgaWYoZGljdCAhPT0gdW5kZWZpbmVkICYmIGRpY3QuaGFzT3duUHJvcGVydHkoJ1Byb2dyYW0nKSl7CgkJCWRpY3RbJ1Byb2dyYW0gQXR0cmlidXRlcyddID0gZ2V0X3Blcm1pc3Npb25zKGRpY3RbJ1Byb2dyYW0nXSk7CiAgICAgICAgICAgIHByb2dyYW1fZGlyID0gZGljdFsnUHJvZ3JhbSddLnNwbGl0KCIvIik7CiAgICAgICAgICAgIHByb2dyYW1fZGlyLnBvcCgpOwogICAgICAgICAgICBwcm9ncmFtX2RpciA9ICIvIiArIHByb2dyYW1fZGlyLmpvaW4oIi8iKTsKICAgICAgICAgICAgZGljdFsnUHJvZ3JhbSBEaXJlY3RvcnkgQXR0cmlidXRlcyddID0gZ2V0X3Blcm1pc3Npb25zKHByb2dyYW1fZGlyKTsKCQl9CgkJb3V0cHV0W2ZpbGVzW2ldXSA9IGRpY3Q7CgkJCgl9CglpZihqc29uPT1mYWxzZSl7CgkJb3V0cHV0ID0gIioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqXG4iICsgIioqKioqIFVzZXIncyBMYXVuY2ggQWdlbnRzICoqKioqXG4iICsgIioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqXG4iICsgSlNPTi5zdHJpbmdpZnkob3V0cHV0LCBudWxsICwgMSk7Cgl9ZWxzZXsKCQlvdXRwdXRbJ0hlYWx0aEluc3BlY3RvckNvbW1hbmQnXSA9ICJVc2VyX0xhdW5jaGFnZW50cyI7CgkJb3V0cHV0ID0gSlNPTi5zdHJpbmdpZnkob3V0cHV0LCBudWxsLCAxKTsKCX0KCXJldHVybiBvdXRwdXQ7fQpmdW5jdGlvbiBVc2VyX0xhdW5jaGRhZW1vbnMoe2hlbHA9ZmFsc2UsIGpzb249ZmFsc2UsIHVzZXI9IiJ9ID0ge30pewoJaWYoaGVscCl7CgkgICAgbGV0IG91dHB1dCA9ICIiOwoJCXJldHVybiBvdXRwdXQ7Cgl9CglsZXQgb3V0cHV0ID0ge307CglsZXQgZmlsZU1hbmFnZXIgPSAkLk5TRmlsZU1hbmFnZXIuZGVmYXVsdE1hbmFnZXI7CglsZXQgY3VycmVudFVzZXJQYXRoID0gIiI7IGlmKHVzZXIgPT09ICIiKXtjdXJyZW50VXNlclBhdGggPSBmaWxlTWFuYWdlci5ob21lRGlyZWN0b3J5Rm9yQ3VycmVudFVzZXIuZmlsZVN5c3RlbVJlcHJlc2VudGF0aW9uO31lbHNle2N1cnJlbnRVc2VyUGF0aCA9ICIvVXNlcnMvIiArIHVzZXI7fQoJbGV0IGZpbGVzID0gT2JqQy5kZWVwVW53cmFwKGZpbGVNYW5hZ2VyLmNvbnRlbnRzT2ZEaXJlY3RvcnlBdFBhdGhFcnJvcihjdXJyZW50VXNlclBhdGggKyAiL0xpYnJhcnkvTGF1bmNoRGFlbW9ucy8iLCBSZWYoKSkpOwoJZm9yKGkgaW4gZmlsZXMpewoJCWxldCBkaWN0ID0gJC5OU011dGFibGVEaWN0aW9uYXJ5LmFsbG9jLmluaXRXaXRoQ29udGVudHNPZkZpbGUoY3VycmVudFVzZXJQYXRoICsgIi9MaWJyYXJ5L0xhdW5jaERhZW1vbnMvIiArIGZpbGVzW2ldKTsKCQlkaWN0ID0gT2JqQy5kZWVwVW53cmFwKGRpY3QpOwoJCWlmKGRpY3QgIT0gdW5kZWZpbmVkICYmIGRpY3QuaGFzT3duUHJvcGVydHkoJ1Byb2dyYW1Bcmd1bWVudHMnKSAmJiBkaWN0WydQcm9ncmFtQXJndW1lbnRzJ10ubGVuZ3RoID4gMCl7CiAgICAgICAgICAgIGRpY3RbJ1Byb2dyYW0gQXR0cmlidXRlcyddID0gZ2V0X3Blcm1pc3Npb25zKGRpY3RbJ1Byb2dyYW1Bcmd1bWVudHMnXVswXSk7CiAgICAgICAgICAgIHByb2dyYW1fZGlyID0gZGljdFsnUHJvZ3JhbUFyZ3VtZW50cyddWzBdLnNwbGl0KCIvIik7CiAgICAgICAgICAgIHByb2dyYW1fZGlyLnBvcCgpOwogICAgICAgICAgICBwcm9ncmFtX2RpciA9ICIvIiArIHByb2dyYW1fZGlyLmpvaW4oIi8iKTsKICAgICAgICAgICAgZGljdFsnUHJvZ3JhbSBEaXJlY3RvcnkgQXR0cmlidXRlcyddID0gZ2V0X3Blcm1pc3Npb25zKHByb2dyYW1fZGlyKTsKCQl9CgkJZWxzZSBpZihkaWN0ICE9PSB1bmRlZmluZWQgJiYgZGljdC5oYXNPd25Qcm9wZXJ0eSgnUHJvZ3JhbScpKXsKCQkJZGljdFsnUHJvZ3JhbSBBdHRyaWJ1dGVzJ10gPSBnZXRfcGVybWlzc2lvbnMoZGljdFsnUHJvZ3JhbSddKTsKICAgICAgICAgICAgcHJvZ3JhbV9kaXIgPSBkaWN0WydQcm9ncmFtJ10uc3BsaXQoIi8iKTsKICAgICAgICAgICAgcHJvZ3JhbV9kaXIucG9wKCk7CiAgICAgICAgICAgIHByb2dyYW1fZGlyID0gIi8iICsgcHJvZ3JhbV9kaXIuam9pbigiLyIpOwogICAgICAgICAgICBkaWN0WydQcm9ncmFtIERpcmVjdG9yeSBBdHRyaWJ1dGVzJ10gPSBnZXRfcGVybWlzc2lvbnMocHJvZ3JhbV9kaXIpOwoJCX0KCQlvdXRwdXRbZmlsZXNbaV1dID0gZGljdDsKCQkgCgl9CglpZihqc29uPT1mYWxzZSl7CgkJb3V0cHV0ID0gIioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqXG4iICsgIioqKioqIFVzZXIncyBMYXVuY2ggRGFlbW9ucyAqKioqKlxuIiArICIqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKlxuIiArIEpTT04uc3RyaW5naWZ5KG91dHB1dCwgbnVsbCAsIDEpOwoJfWVsc2V7CgkJb3V0cHV0WydIZWFsdGhJbnNwZWN0b3JDb21tYW5kJ10gPSAiVXNlcl9MYXVuY2hkYWVtb25zIjsKCQlvdXRwdXQgPSBKU09OLnN0cmluZ2lmeShvdXRwdXQsIG51bGwsIDEpOwoJfQoJcmV0dXJuIG91dHB1dDt9CmZ1bmN0aW9uIFN5c3RlbV9MYXVuY2hkYWVtb25zKHtoZWxwPWZhbHNlLCBqc29uPWZhbHNlLCB1c2VyPSIifSA9IHt9KXsKCWlmKGhlbHApewoJICAgIGxldCBvdXRwdXQgPSAiIjsKCQlyZXR1cm4gb3V0cHV0OwoJfQoJbGV0IG91dHB1dCA9IHt9OwoJbGV0IGZpbGVNYW5hZ2VyID0gJC5OU0ZpbGVNYW5hZ2VyLmRlZmF1bHRNYW5hZ2VyOwoJbGV0IGZpbGVzID0gT2JqQy5kZWVwVW53cmFwKGZpbGVNYW5hZ2VyLmNvbnRlbnRzT2ZEaXJlY3RvcnlBdFBhdGhFcnJvcigiL0xpYnJhcnkvTGF1bmNoRGFlbW9ucy8iLCBSZWYoKSkpOwoJZm9yKGkgaW4gZmlsZXMpewoJCWxldCBkaWN0ID0gJC5OU011dGFibGVEaWN0aW9uYXJ5LmFsbG9jLmluaXRXaXRoQ29udGVudHNPZkZpbGUoIi9MaWJyYXJ5L0xhdW5jaERhZW1vbnMvIiArIGZpbGVzW2ldKTsKCQlkaWN0ID0gT2JqQy5kZWVwVW53cmFwKGRpY3QpOwoJCWlmKGRpY3QgIT0gdW5kZWZpbmVkICYmIGRpY3QuaGFzT3duUHJvcGVydHkoJ1Byb2dyYW1Bcmd1bWVudHMnKSAmJiBkaWN0WydQcm9ncmFtQXJndW1lbnRzJ10ubGVuZ3RoID4gMCl7CiAgICAgICAgICAgIGRpY3RbJ1Byb2dyYW0gQXR0cmlidXRlcyddID0gZ2V0X3Blcm1pc3Npb25zKGRpY3RbJ1Byb2dyYW1Bcmd1bWVudHMnXVswXSk7CiAgICAgICAgICAgIHByb2dyYW1fZGlyID0gZGljdFsnUHJvZ3JhbUFyZ3VtZW50cyddWzBdLnNwbGl0KCIvIik7CiAgICAgICAgICAgIHByb2dyYW1fZGlyLnBvcCgpOwogICAgICAgICAgICBwcm9ncmFtX2RpciA9ICIvIiArIHByb2dyYW1fZGlyLmpvaW4oIi8iKTsKICAgICAgICAgICAgZGljdFsnUHJvZ3JhbSBEaXJlY3RvcnkgQXR0cmlidXRlcyddID0gZ2V0X3Blcm1pc3Npb25zKHByb2dyYW1fZGlyKTsKCQl9CgkJZWxzZSBpZihkaWN0ICE9PSB1bmRlZmluZWQgJiYgZGljdC5oYXNPd25Qcm9wZXJ0eSgnUHJvZ3JhbScpKXsKCQkJZGljdFsnUHJvZ3JhbSBBdHRyaWJ1dGVzJ10gPSBnZXRfcGVybWlzc2lvbnMoZGljdFsnUHJvZ3JhbSddKTsKICAgICAgICAgICAgcHJvZ3JhbV9kaXIgPSBkaWN0WydQcm9ncmFtJ10uc3BsaXQoIi8iKTsKICAgICAgICAgICAgcHJvZ3JhbV9kaXIucG9wKCk7CiAgICAgICAgICAgIHByb2dyYW1fZGlyID0gcHJvZ3JhbV9kaXIuam9pbigiLyIpOwogICAgICAgICAgICAvL2NvbnNvbGUubG9nKHByb2dyYW1fZGlyKTsKICAgICAgICAgICAgZGljdFsnUHJvZ3JhbSBEaXJlY3RvcnkgQXR0cmlidXRlcyddID0gZ2V0X3Blcm1pc3Npb25zKHByb2dyYW1fZGlyKTsKCQl9CgkJb3V0cHV0W2ZpbGVzW2ldXSA9IGRpY3Q7CgkJIAoJfQoJaWYoanNvbj09ZmFsc2UpewoJCW91dHB1dCA9ICIqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKlxuIiArICIqKioqKiBTeXN0ZW0gTGF1bmNoIERhZW1vbnMgKioqKipcbiIgKyAiKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKipcbiIgKyBKU09OLnN0cmluZ2lmeShvdXRwdXQsIG51bGwgLCAxKTsKCX1lbHNlewoJCW91dHB1dFsnSGVhbHRoSW5zcGVjdG9yQ29tbWFuZCddID0gIlN5c3RlbV9MYXVuY2hkYWVtb25zIjsKCQlvdXRwdXQgPSBKU09OLnN0cmluZ2lmeShvdXRwdXQsIG51bGwsIDEpOwoJfQoJcmV0dXJuIG91dHB1dDt9CmZ1bmN0aW9uIEluc3RhbGxlZF9Tb2Z0d2FyZV9WZXJzaW9ucyh7aGVscD1mYWxzZSwganNvbj1mYWxzZSwgdXNlcj0iIn0gPSB7fSl7CglpZihoZWxwKXsKCSAgICBsZXQgb3V0cHV0ID0gIiI7CgkJcmV0dXJuIG91dHB1dDsKCX0KCWxldCBvdXRwdXQgPSB7fTsKCWlmKCFmaWxlX2V4aXN0cygiL0xpYnJhcnkvUmVjZWlwdHMvSW5zdGFsbEhpc3RvcnkucGxpc3QiKSl7CgkJaWYoanNvbj09ZmFsc2UpewoJCQlyZXR1cm4gIioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqXG4iICsgIioqKioqKioqKiogU29mdHdhcmUgVmVyaW9ucyAgKioqKioqKioqXG4iICsgIioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqXG4iICsgIlJlcXVpcmVkIGZpbGUgbm90IGZvdW5kIjsKCQl9ZWxzZXsKCQkJcmV0dXJuIEpTT04uc3RyaW5naWZ5KHsiSGVhbHRoSW5zcGVjdG9yQ29tbWFuZCI6ICJJbnN0YWxsZWRfU29mdHdhcmVfVmVyc2lvbnMifSk7CgkJfQoJfQoJbGV0IGRpY3QgPSAkLk5TQXJyYXkuYWxsb2MuaW5pdFdpdGhDb250ZW50c09mRmlsZSgiL0xpYnJhcnkvUmVjZWlwdHMvSW5zdGFsbEhpc3RvcnkucGxpc3QiKTsKCWxldCBjb250ZW50cyA9IE9iakMuZGVlcFVud3JhcChkaWN0KTsKCWZvcihsZXQgaSBpbiBjb250ZW50cyl7CgkJaWYoIW91dHB1dC5oYXNPd25Qcm9wZXJ0eShjb250ZW50c1tpXVsnZGlzcGxheU5hbWUnXSkpewoJCQlvdXRwdXRbY29udGVudHNbaV1bJ2Rpc3BsYXlOYW1lJ11dID0ge307CgkJfQoJCWlmKG91dHB1dFtjb250ZW50c1tpXVsnZGlzcGxheU5hbWUnXV1bJ3ZlcnNpb24nXSA9PSB1bmRlZmluZWQgfHwKCQkJb3V0cHV0W2NvbnRlbnRzW2ldWydkaXNwbGF5TmFtZSddXVsndmVyc2lvbiddIDwgY29udGVudHNbaV1bJ2Rpc3BsYXlWZXJzaW9uJ10pewoJCQkvLyB1cGRhdGUgb3VyIGluZm9ybWF0aW9uIGlmIHdlIGZpbmQgYSBuZXdlciB2ZXJzaW9uIGxpc3RlZAoJCQlvdXRwdXRbY29udGVudHNbaV1bJ2Rpc3BsYXlOYW1lJ11dWydkYXRlJ10gPSBjb250ZW50c1tpXVsnZGF0ZSddOwoJCQlvdXRwdXRbY29udGVudHNbaV1bJ2Rpc3BsYXlOYW1lJ11dWyd2ZXJzaW9uJ10gPSBjb250ZW50c1tpXVsnZGlzcGxheVZlcnNpb24nXTsKCQkJb3V0cHV0W2NvbnRlbnRzW2ldWydkaXNwbGF5TmFtZSddXVsncHJvY2Vzc05hbWUnXSA9IGNvbnRlbnRzW2ldWydwcm9jZXNzTmFtZSddOwoJCX0KCQkKCX0KCWlmKGpzb249PWZhbHNlKXsKCQlvdXRwdXQgPSAiKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKipcbiIgKyAiKioqKioqKioqKiBTb2Z0d2FyZSBWZXJpb25zICAqKioqKioqKipcbiIgKyAiKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKipcbiIgKyBKU09OLnN0cmluZ2lmeShvdXRwdXQsIG51bGwgLCAxKTsKCX1lbHNlewoJCW91dHB1dFsnSGVhbHRoSW5zcGVjdG9yQ29tbWFuZCddID0gIkluc3RhbGxlZF9Tb2Z0d2FyZV9WZXJzaW9ucyI7CgkJb3V0cHV0ID0gSlNPTi5zdHJpbmdpZnkob3V0cHV0LCBudWxsLCAxKTsKCX0KCXJldHVybiBvdXRwdXQ7fQovLyAtLS0tLS0tLS0tLSB1c2VyIGRhdGEgbWluaW5nIGZ1bmN0aW9ucyAtLS0tLS0tLS0tLS0tCmZ1bmN0aW9uIFVuaXF1ZV9CYXNoX0hpc3RvcnlfU2Vzc2lvbnMoe2hlbHA9ZmFsc2UsIGpzb249ZmFsc2UsIHVzZXI9IiJ9ID0ge30pewoJaWYoaGVscCl7CgkgICAgbGV0IG91dHB1dCA9ICIiOwoJCXJldHVybiBvdXRwdXQ7Cgl9CglsZXQgb3V0cHV0ID0ge307CglsZXQgZmlsZU1hbmFnZXIgPSAkLk5TRmlsZU1hbmFnZXIuZGVmYXVsdE1hbmFnZXI7CglsZXQgY3VycmVudFVzZXJQYXRoID0gIiI7IGlmKHVzZXIgPT09ICIiKXtjdXJyZW50VXNlclBhdGggPSBmaWxlTWFuYWdlci5ob21lRGlyZWN0b3J5Rm9yQ3VycmVudFVzZXIuZmlsZVN5c3RlbVJlcHJlc2VudGF0aW9uO31lbHNle2N1cnJlbnRVc2VyUGF0aCA9ICIvVXNlcnMvIiArIHVzZXI7fQoJbGV0IGZpbGVzID0gT2JqQy5kZWVwVW53cmFwKGZpbGVNYW5hZ2VyLmNvbnRlbnRzT2ZEaXJlY3RvcnlBdFBhdGhFcnJvcihjdXJyZW50VXNlclBhdGggKyAiLy5iYXNoX3Nlc3Npb25zLyIsIFJlZigpKSk7CglsZXQgZmluYWxfY29tbWFuZHMgPSBuZXcgU2V0KCk7Cglmb3IoaSBpbiBmaWxlcyl7CgkJbGV0IGxpc3QgPSAkLk5TU3RyaW5nLmFsbG9jLmluaXRXaXRoQ29udGVudHNPZkZpbGVFbmNvZGluZ0Vycm9yKGN1cnJlbnRVc2VyUGF0aCArICIvLmJhc2hfc2Vzc2lvbnMvIiArIGZpbGVzW2ldLCAkLk5TVVRGOFN0cmluZ0VuY29kaW5nLCAkKCkpLmpzLnNwbGl0KCJcbiIpOwoJCWZvcihsZXQgaiBpbiBsaXN0KXsKCQkJZmluYWxfY29tbWFuZHMuYWRkKGxpc3Rbal0pOwoJCX0KCX0KCWxldCBsaXN0ID0gJC5OU1N0cmluZy5hbGxvYy5pbml0V2l0aENvbnRlbnRzT2ZGaWxlRW5jb2RpbmdFcnJvcihjdXJyZW50VXNlclBhdGggKyAiLy5iYXNoX2hpc3RvcnkiLCAkLk5TVVRGOFN0cmluZ0VuY29kaW5nLCAkKCkpLmpzOwoJaWYobGlzdCAhPSB1bmRlZmluZWQpewoJCWxpc3QgPSBsaXN0LnNwbGl0KCJcbiIpOwoJCWZvcihsZXQgaiBpbiBsaXN0KXsKCQkJZmluYWxfY29tbWFuZHMuYWRkKGxpc3Rbal0pOwoJCX0KCX0KCWxpc3QgPSAkLk5TU3RyaW5nLmFsbG9jLmluaXRXaXRoQ29udGVudHNPZkZpbGVFbmNvZGluZ0Vycm9yKGN1cnJlbnRVc2VyUGF0aCArICIvLnpzaF9oaXN0b3J5IiwgJC5OU1VURjhTdHJpbmdFbmNvZGluZywgJCgpKS5qczsKCWlmKGxpc3QgIT0gdW5kZWZpbmVkKXsKCQlsaXN0ID0gbGlzdC5zcGxpdCgiXG4iKTsKCQlmb3IobGV0IGogaW4gbGlzdCl7CgkJCWZpbmFsX2NvbW1hbmRzLmFkZChsaXN0W2pdKTsKCQl9Cgl9CglvdXRwdXRbJ2NvbW1hbmRzJ10gPSBBcnJheS5mcm9tKGZpbmFsX2NvbW1hbmRzKTsKCWlmKGpzb249PWZhbHNlKXsKCQlvdXRwdXQgPSAiKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKipcbiIgKyAiKioqKioqKiBVbmlxdWUgQmFzaCBIaXN0b3J5ICoqKioqKipcbiIgKyAiKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKipcbiIgKyBKU09OLnN0cmluZ2lmeShvdXRwdXQsIG51bGwgLCAxKTsKCX1lbHNlewoJCW91dHB1dFsnSGVhbHRoSW5zcGVjdG9yQ29tbWFuZCddID0gIlVuaXF1ZV9CYXNoX0hpc3RvcnlfU2Vzc2lvbnMiOwoJCW91dHB1dCA9IEpTT04uc3RyaW5naWZ5KG91dHB1dCwgbnVsbCwgMSk7Cgl9CglyZXR1cm4gb3V0cHV0O30KZnVuY3Rpb24gU1NIX0tleXMoe2hlbHA9ZmFsc2UsIGpzb249ZmFsc2UsIHVzZXI9IiJ9ID0ge30pewoJaWYoaGVscCl7CgkgICAgbGV0IG91dHB1dCA9ICIiOwoJCXJldHVybiBvdXRwdXQ7Cgl9CglsZXQgb3V0cHV0ID0ge307CglsZXQgZmlsZU1hbmFnZXIgPSAkLk5TRmlsZU1hbmFnZXIuZGVmYXVsdE1hbmFnZXI7CglsZXQgY3VycmVudFVzZXJQYXRoID0gIiI7IGlmKHVzZXIgPT09ICIiKXtjdXJyZW50VXNlclBhdGggPSBmaWxlTWFuYWdlci5ob21lRGlyZWN0b3J5Rm9yQ3VycmVudFVzZXIuZmlsZVN5c3RlbVJlcHJlc2VudGF0aW9uO31lbHNle2N1cnJlbnRVc2VyUGF0aCA9ICIvVXNlcnMvIiArIHVzZXI7fQoJbGV0IGZpbGVzID0gT2JqQy5kZWVwVW53cmFwKGZpbGVNYW5hZ2VyLmNvbnRlbnRzT2ZEaXJlY3RvcnlBdFBhdGhFcnJvcihjdXJyZW50VXNlclBhdGggKyAiLy5zc2giLCBSZWYoKSkpOwoJZm9yKGkgaW4gZmlsZXMpewoJCWxldCBkaWN0ID0gJC5OU1N0cmluZy5hbGxvYy5pbml0V2l0aENvbnRlbnRzT2ZGaWxlRW5jb2RpbmdFcnJvcihjdXJyZW50VXNlclBhdGggKyAiLy5zc2gvIiArIGZpbGVzW2ldLCAkLk5TVVRGOFN0cmluZ0VuY29kaW5nLCAkKCkpOwoJCWRpY3QgPSBPYmpDLmRlZXBVbndyYXAoZGljdCk7CgkJb3V0cHV0W2ZpbGVzW2ldXSA9IGRpY3Q7CgkJCgl9CglpZihqc29uPT1mYWxzZSl7CgkJb3V0cHV0ID0gIioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqXG4iICsgIioqKioqKioqKiBTU0ggS2V5IEZpbGVzICoqKioqKioqKlxuIiArICIqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKlxuIiArIEpTT04uc3RyaW5naWZ5KG91dHB1dCwgbnVsbCAsIDEpOwoJfWVsc2V7CgkJb3V0cHV0WydIZWFsdGhJbnNwZWN0b3JDb21tYW5kJ10gPSAiU1NIX0tleXMiOwoJCW91dHB1dCA9IEpTT04uc3RyaW5naWZ5KG91dHB1dCwgbnVsbCwgMSk7Cgl9CglyZXR1cm4gb3V0cHV0O30KZnVuY3Rpb24gU2xhY2tfRG93bmxvYWRfQ2FjaGVfSGlzdG9yeSh7aGVscD1mYWxzZSwganNvbj1mYWxzZSwgdXNlcj0iIn0gPSB7fSl7CglpZihoZWxwKXsKCSAgICBsZXQgb3V0cHV0ID0gIiI7CgkJcmV0dXJuIG91dHB1dDsKCX0KCWxldCBvdXRwdXQgPSB7fTsKCWxldCBmaWxlTWFuYWdlciA9ICQuTlNGaWxlTWFuYWdlci5kZWZhdWx0TWFuYWdlcjsKCWxldCBjdXJyZW50VXNlclBhdGggPSAiIjsgaWYodXNlciA9PT0gIiIpe2N1cnJlbnRVc2VyUGF0aCA9IGZpbGVNYW5hZ2VyLmhvbWVEaXJlY3RvcnlGb3JDdXJyZW50VXNlci5maWxlU3lzdGVtUmVwcmVzZW50YXRpb247fWVsc2V7Y3VycmVudFVzZXJQYXRoID0gIi9Vc2Vycy8iICsgdXNlcjt9CglpZighZmlsZV9leGlzdHMoY3VycmVudFVzZXJQYXRoICsgIi9MaWJyYXJ5L0FwcGxpY2F0aW9uIFN1cHBvcnQvU2xhY2svc3RvcmFnZS9zbGFjay1kb3dubG9hZHMiKSl7CgkJaWYoanNvbj09ZmFsc2UpewoJCQlyZXR1cm4gIioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqXG4iICsgIioqKioqKioqKiBTbGFjayBEb3dubG9hZHMgKioqKioqKioqXG4iICsgIioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqXG4iICsgIlJlcXVpcmVkIGZpbGUgbm90IGZvdW5kIjsKCQl9ZWxzZXsKCQkJcmV0dXJuIEpTT04uc3RyaW5naWZ5KHsiSGVhbHRoSW5zcGVjdG9yQ29tbWFuZCI6ICJTbGFja19Eb3dubG9hZF9DYWNoZV9IaXN0b3J5In0pOwoJCX0KCX0KCWxldCBkaWN0ID0gJC5OU1N0cmluZy5hbGxvYy5pbml0V2l0aENvbnRlbnRzT2ZGaWxlRW5jb2RpbmdFcnJvcihjdXJyZW50VXNlclBhdGggKyAiL0xpYnJhcnkvQXBwbGljYXRpb24gU3VwcG9ydC9TbGFjay9zdG9yYWdlL3NsYWNrLWRvd25sb2FkcyIsICQuTlNVVEY4U3RyaW5nRW5jb2RpbmcsICQoKSkuanM7CglpZihkaWN0ICE9ICIiICYmIGRpY3QgIT0gdW5kZWZpbmVkKXsKCQlkaWN0ID0gSlNPTi5wYXJzZShkaWN0KTsKCQl0ZWFtX2tleXMgPSBPYmplY3Qua2V5cyhkaWN0KTsKCQlvdXRwdXRbJ3NsYWNrIGRvd25sb2FkIGNhY2hlIGhpc3RvcnknXSA9IFtdOwoJCWZvcihsZXQgdGVhbV9rZXkgaW4gdGVhbV9rZXlzKXsKCQkJbGV0IGZpbGVfa2V5cyA9IE9iamVjdC5rZXlzKGRpY3RbdGVhbV9rZXlzW3RlYW1fa2V5XV0pOwoJCQlmb3IobGV0IGZpbGVfa2V5IGluIGZpbGVfa2V5cyl7CgkJCQlvdXRwdXRbJ3NsYWNrIGRvd25sb2FkIGNhY2hlIGhpc3RvcnknXS5wdXNoKHsidXJsIjpkaWN0W3RlYW1fa2V5c1t0ZWFtX2tleV1dW2ZpbGVfa2V5c1tmaWxlX2tleV1dWyd1cmwnXSwgImRvd25sb2FkIHBhdGgiOiBkaWN0W3RlYW1fa2V5c1t0ZWFtX2tleV1dW2ZpbGVfa2V5c1tmaWxlX2tleV1dWydkb3dubG9hZFBhdGgnXX0pOwoJCQl9CgkJfQoJfQoJaWYoanNvbj09ZmFsc2UpewoJCW91dHB1dCA9ICIqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKlxuIiArICIqKioqKioqKiogU2xhY2sgRG93bmxvYWRzICoqKioqKioqKlxuIiArICIqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKlxuIiArIEpTT04uc3RyaW5naWZ5KG91dHB1dCwgbnVsbCAsIDEpOwoJfWVsc2V7CgkJb3V0cHV0WydIZWFsdGhJbnNwZWN0b3JDb21tYW5kJ10gPSAiU2xhY2tfRG93bmxvYWRfQ2FjaGVfSGlzdG9yeSI7CgkJb3V0cHV0ID0gSlNPTi5zdHJpbmdpZnkob3V0cHV0LCBudWxsLCAxKTsKCX0KCXJldHVybiBvdXRwdXQ7fQpmdW5jdGlvbiBTbGFja19UZWFtX0luZm9ybWF0aW9uKHtoZWxwPWZhbHNlLCBqc29uPWZhbHNlLCB1c2VyPSIifSA9IHt9KXsKCWlmKGhlbHApewoJICAgIGxldCBvdXRwdXQgPSAiIjsKCQlyZXR1cm4gb3V0cHV0OwoJfQoJbGV0IG91dHB1dCA9IHt9OwoJbGV0IGZpbGVNYW5hZ2VyID0gJC5OU0ZpbGVNYW5hZ2VyLmRlZmF1bHRNYW5hZ2VyOwoJbGV0IGN1cnJlbnRVc2VyUGF0aCA9ICIiOyBpZih1c2VyID09PSAiIil7Y3VycmVudFVzZXJQYXRoID0gZmlsZU1hbmFnZXIuaG9tZURpcmVjdG9yeUZvckN1cnJlbnRVc2VyLmZpbGVTeXN0ZW1SZXByZXNlbnRhdGlvbjt9ZWxzZXtjdXJyZW50VXNlclBhdGggPSAiL1VzZXJzLyIgKyB1c2VyO30KCWlmKCFmaWxlX2V4aXN0cyhjdXJyZW50VXNlclBhdGggKyAiL0xpYnJhcnkvQXBwbGljYXRpb24gU3VwcG9ydC9TbGFjay9zdG9yYWdlL3NsYWNrLXRlYW1zIikpewoJCWlmKGpzb249PWZhbHNlKXsKCQkJcmV0dXJuICIqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKlxuIiArICIqKioqKioqKiogU2xhY2sgVGVhbSBJbmZvICoqKioqKioqKlxuIiArICIqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKlxuIiArICJSZXF1aXJlZCBmaWxlIG5vdCBmb3VuZCI7CgkJfWVsc2V7CgkJCXJldHVybiBKU09OLnN0cmluZ2lmeSh7IkhlYWx0aEluc3BlY3RvckNvbW1hbmQiOiAiU2xhY2tfVGVhbV9JbmZvcm1hdGlvbiJ9KTsKCQl9Cgl9CglsZXQgZGljdCA9ICQuTlNTdHJpbmcuYWxsb2MuaW5pdFdpdGhDb250ZW50c09mRmlsZUVuY29kaW5nRXJyb3IoY3VycmVudFVzZXJQYXRoICsgIi9MaWJyYXJ5L0FwcGxpY2F0aW9uIFN1cHBvcnQvU2xhY2svc3RvcmFnZS9zbGFjay10ZWFtcyIsICQuTlNVVEY4U3RyaW5nRW5jb2RpbmcsICQoKSkuanM7CglpZihkaWN0ICE9ICIiICYmIGRpY3QgIT0gdW5kZWZpbmVkKXsKCQlkaWN0ID0gSlNPTi5wYXJzZShkaWN0KTsKCQlrZXlzID0gT2JqZWN0LmtleXMoZGljdCk7CgkJZm9yKGxldCBrZXkgaW4ga2V5cyl7CgkJCWRlbGV0ZSBkaWN0W2tleXNba2V5XV1bJ3RoZW1lJ107CgkJCWRlbGV0ZSBkaWN0W2tleXNba2V5XV1bJ2ljb25zJ107CgkJfQoJCW91dHB1dFsnc2xhY2sgdGVhbSBpbmZvcm1hdGlvbiddID0gZGljdDsKCX0KCWlmKGpzb249PWZhbHNlKXsKCQlvdXRwdXQgPSAiKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKipcbiIgKyAiKioqKioqKioqIFNsYWNrIFRlYW0gSW5mbyAqKioqKioqKipcbiIgKyAiKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKipcbiIgKyBKU09OLnN0cmluZ2lmeShvdXRwdXQsIG51bGwgLCAxKTsKCX1lbHNlewoJCW91dHB1dFsnSGVhbHRoSW5zcGVjdG9yQ29tbWFuZCddID0gIlNsYWNrX1RlYW1fSW5mb3JtYXRpb24iOwoJCW91dHB1dCA9IEpTT04uc3RyaW5naWZ5KG91dHB1dCwgbnVsbCwgMSk7Cgl9CglyZXR1cm4gb3V0cHV0O30KZnVuY3Rpb24gUmVjZW50X0ZpbGVzKHtoZWxwPWZhbHNlLCBqc29uPWZhbHNlLCB1c2VyPSIifSA9IHt9KXsKCWlmKGhlbHApewoJICAgIGxldCBvdXRwdXQgPSAiIjsKCQlyZXR1cm4gb3V0cHV0OwoJfQoJbGV0IG91dHB1dCA9IHt9OwoJbGV0IGZpbGVNYW5hZ2VyID0gJC5OU0ZpbGVNYW5hZ2VyLmRlZmF1bHRNYW5hZ2VyOwoJbGV0IGN1cnJlbnRVc2VyUGF0aCA9ICIiOyBpZih1c2VyID09PSAiIil7Y3VycmVudFVzZXJQYXRoID0gZmlsZU1hbmFnZXIuaG9tZURpcmVjdG9yeUZvckN1cnJlbnRVc2VyLmZpbGVTeXN0ZW1SZXByZXNlbnRhdGlvbjt9ZWxzZXtjdXJyZW50VXNlclBhdGggPSAiL1VzZXJzLyIgKyB1c2VyO30KCW91dHB1dFsnUmVjZW50IEFwcGxpY2F0aW9ucyddID0gW107CglpZighZmlsZV9leGlzdHMoY3VycmVudFVzZXJQYXRoICsgIi9MaWJyYXJ5L0FwcGxpY2F0aW9uIFN1cHBvcnQvY29tLmFwcGxlLnNoYXJlZGZpbGVsaXN0L2NvbS5hcHBsZS5MU1NoYXJlZEZpbGVMaXN0LlJlY2VudEFwcGxpY2F0aW9ucy5zZmwyIikpewoJCWlmKGpzb249PWZhbHNlKXsKCQkJcmV0dXJuICIqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKlxuIiArICIqKioqKiBVc2VyJ3MgcmVjZW50IGFwcGxpY2F0aW9ucyAqKioqKlxuIiArICIqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKlxuIiArICJSZXF1aXJlZCBmaWxlIG5vdCBmb3VuZCI7CgkJfWVsc2V7CgkJCXJldHVybiBKU09OLnN0cmluZ2lmeSh7IkhlYWx0aEluc3BlY3RvckNvbW1hbmQiOiAiUmVjZW50X0ZpbGVzIn0pOwoJCX0KCX0KCWxldCBkaWN0ID0gJC5OU011dGFibGVEaWN0aW9uYXJ5LmFsbG9jLmluaXRXaXRoQ29udGVudHNPZkZpbGUoY3VycmVudFVzZXJQYXRoICsgIi9MaWJyYXJ5L0FwcGxpY2F0aW9uIFN1cHBvcnQvY29tLmFwcGxlLnNoYXJlZGZpbGVsaXN0L2NvbS5hcHBsZS5MU1NoYXJlZEZpbGVMaXN0LlJlY2VudEFwcGxpY2F0aW9ucy5zZmwyIik7CglsZXQgY29udGVudHMgPSBPYmpDLmRlZXBVbndyYXAoZGljdCk7CglpZihjb250ZW50cyA9PT0gdW5kZWZpbmVkKXsKCQlpZihqc29uPT1mYWxzZSl7CgkJCXJldHVybiAiKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKipcbiIgKyAiKioqKiogVXNlcidzIHJlY2VudCBhcHBsaWNhdGlvbnMgKioqKipcbiIgKyAiKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKipcbiIgKyAiQmxvY2tlZCBieSBUQ0MiOwoJCX1lbHNlewoJCQlyZXR1cm4gSlNPTi5zdHJpbmdpZnkoeyJIZWFsdGhJbnNwZWN0b3JDb21tYW5kIjogIlJlY2VudF9GaWxlcyJ9KTsKCQl9Cgl9Cglmb3IobGV0IGkgPSAwOyBpIDwgY29udGVudHNbJyRvYmplY3RzJ10ubGVuZ3RoOyBpKyspewoJCWlmKHR5cGVvZiBjb250ZW50c1snJG9iamVjdHMnXVtpXSA9PSAic3RyaW5nIiAmJiBjb250ZW50c1snJG9iamVjdHMnXVtpXS5pbmNsdWRlcygiLmFwcCIpKXsKCQkJb3V0cHV0WydSZWNlbnQgQXBwbGljYXRpb25zJ10ucHVzaChjb250ZW50c1snJG9iamVjdHMnXVtpXSk7CgkJfQoJfQoJaWYoanNvbj09ZmFsc2UpewoJCW91dHB1dCA9ICIqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKlxuIiArICIqKioqKiBVc2VyJ3MgcmVjZW50IGFwcGxpY2F0aW9ucyAqKioqKlxuIiArICIqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKlxuIiArIEpTT04uc3RyaW5naWZ5KG91dHB1dCwgbnVsbCAsIDEpOwoJfWVsc2V7CgkJb3V0cHV0WydIZWFsdGhJbnNwZWN0b3JDb21tYW5kJ10gPSAiUmVjZW50X0ZpbGVzIjsKCQlvdXRwdXQgPSBKU09OLnN0cmluZ2lmeShvdXRwdXQsIG51bGwsIDEpOwoJfQoJcmV0dXJuIG91dHB1dDt9Ci8vLS0tLS0tLS0tLS0tIGdsb2JhbGx5IHJlYWRhYmxlIHBsaXN0cyB3aXRoIGludGVyZXN0aW5nIGluZm8gLS0tLS0tLS0tLS0tLS0tLS0tCmZ1bmN0aW9uIEZpcmV3YWxsKHtoZWxwPWZhbHNlLCBqc29uPWZhbHNlLCB1c2VyPSIifSA9IHt9KXsKCWlmKGhlbHApewoJICAgIGxldCBvdXRwdXQgPSAiIjsKCQlyZXR1cm4gb3V0cHV0OwoJfQoJbGV0IG91dHB1dCA9IHt9OwoJbGV0IGZpbGVNYW5hZ2VyID0gJC5OU0ZpbGVNYW5hZ2VyLmRlZmF1bHRNYW5hZ2VyOwoJaWYoIWZpbGVfZXhpc3RzKCIvTGlicmFyeS9QcmVmZXJlbmNlcy9jb20uYXBwbGUuYWxmLnBsaXN0IikpewoJCWlmKGpzb249PWZhbHNlKXsKCQkJcmV0dXJuICIqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKlxuIiArICIqKioqKioqIEZpcmV3YWxsIFByZWZlcmVuY2VzICoqKioqKipcbiIgKyAiKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKipcbiIgKyAiUmVxdWlyZWQgZmlsZSBub3QgZm91bmQiOwoJCX1lbHNlewoJCQlyZXR1cm4gSlNPTi5zdHJpbmdpZnkoeyJIZWFsdGhJbnNwZWN0b3JDb21tYW5kIjogIkZpcmV3YWxsIn0pOwoJCX0KCX0KCWxldCBkaWN0ID0gJC5OU011dGFibGVEaWN0aW9uYXJ5LmFsbG9jLmluaXRXaXRoQ29udGVudHNPZkZpbGUoIi9MaWJyYXJ5L1ByZWZlcmVuY2VzL2NvbS5hcHBsZS5hbGYucGxpc3QiKTsKCWxldCBjb250ZW50cyA9IE9iakMuZGVlcFVud3JhcChkaWN0KTsKCW91dHB1dFsnR2xvYmFsIFN0YXRlJ10gPSBjb250ZW50c1snZ2xvYmFsc3RhdGUnXTsKCW91dHB1dFsnU3RlYWx0aCBFbmFibGVkJ10gPSBjb250ZW50c1snc3RlYWx0aGVuYWJsZWQnXTsKCW91dHB1dFsnTG9nZ2luZyddID0gY29udGVudHNbJ2xvZ2dpbmdlbmFibGVkJ107CglkaWN0ID0gJC5OU011dGFibGVEaWN0aW9uYXJ5LmFsbG9jLmluaXRXaXRoQ29udGVudHNPZkZpbGUoIi9MaWJyYXJ5L1ByZWZlcmVuY2VzL2NvbS5hcHBsZS5BUkRBZ2VudC5wbGlzdCIpOwoJb3V0cHV0WydBUkRBZ2VudCddID0gT2JqQy5kZWVwVW53cmFwKGRpY3QpOwoJZGljdCA9ICQuTlNNdXRhYmxlRGljdGlvbmFyeS5hbGxvYy5pbml0V2l0aENvbnRlbnRzT2ZGaWxlKCIvTGlicmFyeS9QcmVmZXJlbmNlcy9jb20uYXBwbGUuUmVtb3RlRGVza3RvcC5wbGlzdCIpOwoJb3V0cHV0WydSZW1vdGVEZXNrdG9wJ10gPSBPYmpDLmRlZXBVbndyYXAoZGljdCk7CglkaWN0ID0gJC5OU011dGFibGVEaWN0aW9uYXJ5LmFsbG9jLmluaXRXaXRoQ29udGVudHNPZkZpbGUoIi9MaWJyYXJ5L1ByZWZlcmVuY2VzL2NvbS5hcHBsZS5SZW1vdGVNYW5hZ2VtZW50LnBsaXN0Iik7CglvdXRwdXRbJ1JlbW90ZU1hbmFnZW1lbnQnXSA9IE9iakMuZGVlcFVud3JhcChkaWN0KTsKCWRpY3QgPSAkLk5TU3RyaW5nLmFsbG9jLmluaXRXaXRoQ29udGVudHNPZkZpbGUoIi9MaWJyYXJ5L1ByZWZlcmVuY2VzL2NvbS5hcHBsZS5WTkNTZXR0aW5ncy50eHQiKTsKCW91dHB1dFsnVk5DU2V0dGluZ3MnXSA9IE9iakMuZGVlcFVud3JhcChkaWN0KTsKCWlmKGpzb249PWZhbHNlKXsKCQlvdXRwdXQgPSAiKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKipcbiIgKyAiKioqKioqKiBGaXJld2FsbCBQcmVmZXJlbmNlcyAqKioqKioqXG4iICsgIioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqXG4iICsgSlNPTi5zdHJpbmdpZnkob3V0cHV0LCBudWxsICwgMSk7Cgl9ZWxzZXsKCQlvdXRwdXRbJ0hlYWx0aEluc3BlY3RvckNvbW1hbmQnXSA9ICJGaXJld2FsbCI7CgkJb3V0cHV0ID0gSlNPTi5zdHJpbmdpZnkob3V0cHV0LCBudWxsLCAxKTsKCX0KCXJldHVybiBvdXRwdXQ7fQpmdW5jdGlvbiBBaXJwb3J0X1ByZWZlcmVuY2VzKHtoZWxwPWZhbHNlLCBqc29uPWZhbHNlLCB1c2VyPSIifSA9IHt9KXsKCWlmKGhlbHApewoJICAgIGxldCBvdXRwdXQgPSAiIjsKCQlyZXR1cm4gb3V0cHV0OwoJfQoJbGV0IG91dHB1dCA9IHt9OwoJbGV0IGZpbGVNYW5hZ2VyID0gJC5OU0ZpbGVNYW5hZ2VyLmRlZmF1bHRNYW5hZ2VyOwoJaWYoIWZpbGVfZXhpc3RzKCIvTGlicmFyeS9QcmVmZXJlbmNlcy9TeXN0ZW1Db25maWd1cmF0aW9uL2NvbS5hcHBsZS5haXJwb3J0LnByZWZlcmVuY2VzLnBsaXN0IikpewoJCWlmKGpzb249PWZhbHNlKXsKCQkJcmV0dXJuICIqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKlxuIiArICIqKioqKioqKiBBaXJwb3J0IFByZWZlcmVuY2VzICoqKioqKioqXG4iICsgIioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqXG4iICsgIlJlcXVpcmVkIGZpbGUgbm90IGZvdW5kIjsKCQl9ZWxzZXsKCQkJcmV0dXJuIEpTT04uc3RyaW5naWZ5KHsiSGVhbHRoSW5zcGVjdG9yQ29tbWFuZCI6ICJBaXJwb3J0X1ByZWZlcmVuY2VzIn0pOwoJCX0KCX0KCWxldCBkaWN0ID0gJC5OU011dGFibGVEaWN0aW9uYXJ5LmFsbG9jLmluaXRXaXRoQ29udGVudHNPZkZpbGUoIi9MaWJyYXJ5L1ByZWZlcmVuY2VzL1N5c3RlbUNvbmZpZ3VyYXRpb24vY29tLmFwcGxlLmFpcnBvcnQucHJlZmVyZW5jZXMucGxpc3QiKTsKCWxldCBjb250ZW50cyA9IE9iakMuZGVlcFVud3JhcChkaWN0KTsKCW91dHB1dFsnS25vd24gTmV0d29ya3MnXSA9IFtdOwoJaWYoY29udGVudHNbIktub3duTmV0d29ya3MiXSAhPT0gdW5kZWZpbmVkKXsKCQlsZXQgd2lmaV9rZXlzID0gT2JqZWN0LmtleXMoY29udGVudHNbJ0tub3duTmV0d29ya3MnXSk7CgkJbGV0IGhleF90b19zc2lkID0ge307CgkJZm9yKGxldCBpIGluIHdpZmlfa2V5cyl7CgkJCWhleF90b19zc2lkW3dpZmlfa2V5c1tpXV0gPSBjb250ZW50c1snS25vd25OZXR3b3JrcyddW3dpZmlfa2V5c1tpXV1bJ1NTSURTdHJpbmcnXTsKCQl9CgkJZm9yKGxldCBpIGluIHdpZmlfa2V5cyl7CgkJCWxldCBTU0lEID0gY29udGVudHNbJ0tub3duTmV0d29ya3MnXVt3aWZpX2tleXNbaV1dWydTU0lEU3RyaW5nJ107CgkJCWxldCBTZWN1cml0eVR5cGUgPSBjb250ZW50c1snS25vd25OZXR3b3JrcyddW3dpZmlfa2V5c1tpXV1bJ1NlY3VyaXR5VHlwZSddOwoJCQlsZXQgbGFzdENvbm5lY3RlZCA9IGNvbnRlbnRzWydLbm93bk5ldHdvcmtzJ11bd2lmaV9rZXlzW2ldXVsnTGFzdENvbm5lY3RlZCddOwoJCQlsZXQgd2FzQ2FwdGl2ZSA9IGNvbnRlbnRzWydLbm93bk5ldHdvcmtzJ11bd2lmaV9rZXlzW2ldXVsnTmV0d29ya1dhc0NhcHRpdmUnXTsKCQkJbGV0IGNhcHRpdmVCeXBhc3MgPSBjb250ZW50c1snS25vd25OZXR3b3JrcyddW3dpZmlfa2V5c1tpXV1bJ0NhcHRpdmVCeXBhc3MnXTsKCQkJbGV0IGNvbGxvY2F0ZWRHcm91cCA9IFtdOwoJCQlmb3IobGV0IGogPSAwOyBqIDwgY29udGVudHNbJ0tub3duTmV0d29ya3MnXVt3aWZpX2tleXNbaV1dWydDb2xsb2NhdGVkR3JvdXAnXS5sZW5ndGg7IGorKyl7CgkJCQljb2xsb2NhdGVkR3JvdXAucHVzaChoZXhfdG9fc3NpZFtjb250ZW50c1snS25vd25OZXR3b3JrcyddW3dpZmlfa2V5c1tpXV1bJ0NvbGxvY2F0ZWRHcm91cCddW2pdXSk7CgkJCX0KCQkJb3V0cHV0WydLbm93biBOZXR3b3JrcyddLnB1c2goeyJTU0lEIjogU1NJRCwgIlNlY3VyaXR5IjogU2VjdXJpdHlUeXBlLCAiTGFzdCBDb25uZWN0aW9uIjogbGFzdENvbm5lY3RlZCwKCQkJCQkJCQkJCSAgICJXYXMgQ2FwdGl2ZSI6IHdhc0NhcHRpdmUsICJDYXB0aXZlIEJ5cGFzcyI6IGNhcHRpdmVCeXBhc3MsCgkJCQkJCQkJCQkgICAiTmVhcmJ5IE5ldHdvcmtzIjogY29sbG9jYXRlZEdyb3VwfSkKCQl9Cgl9CglpZihqc29uPT1mYWxzZSl7CgkJb3V0cHV0ID0gIioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqXG4iICsgIioqKioqKioqIEFpcnBvcnQgUHJlZmVyZW5jZXMgKioqKioqKipcbiIgKyAiKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKipcbiIgKyBKU09OLnN0cmluZ2lmeShvdXRwdXQsIG51bGwgLCAxKTsKCX1lbHNlewoJCW91dHB1dFsnSGVhbHRoSW5zcGVjdG9yQ29tbWFuZCddID0gIkFpcnBvcnRfUHJlZmVyZW5jZXMiOwoJCW91dHB1dCA9IEpTT04uc3RyaW5naWZ5KG91dHB1dCwgbnVsbCwgMSk7Cgl9CglyZXR1cm4gb3V0cHV0O30KZnVuY3Rpb24gU01CX1NlcnZlcih7aGVscD1mYWxzZSwganNvbj1mYWxzZSwgdXNlcj0iIn0gPSB7fSl7CglpZihoZWxwKXsKCSAgICBsZXQgb3V0cHV0ID0gIiI7CgkJcmV0dXJuIG91dHB1dDsKCX0KCWxldCBvdXRwdXQgPSB7fTsKCWxldCBmaWxlTWFuYWdlciA9ICQuTlNGaWxlTWFuYWdlci5kZWZhdWx0TWFuYWdlcjsKCWlmKCFmaWxlX2V4aXN0cygiL0xpYnJhcnkvUHJlZmVyZW5jZXMvU3lzdGVtQ29uZmlndXJhdGlvbi9jb20uYXBwbGUuc21iLnNlcnZlci5wbGlzdCIpKXsKCQlpZihqc29uPT1mYWxzZSl7CgkJCXJldHVybiAiKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKipcbiIgKyAiKioqKioqKiBTTUIgU2VydmVyIFByZWZlcmVuY2VzICoqKioqKipcbiIgKyAiKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKipcbiIgKyAiUmVxdWlyZWQgZmlsZSBub3QgZm91bmQiOwoJCX1lbHNlewoJCQlyZXR1cm4gSlNPTi5zdHJpbmdpZnkoeyJIZWFsdGhJbnNwZWN0b3JDb21tYW5kIjogIlNNQl9TZXJ2ZXIifSk7CgkJfQoJfQoJbGV0IGRpY3QgPSAkLk5TTXV0YWJsZURpY3Rpb25hcnkuYWxsb2MuaW5pdFdpdGhDb250ZW50c09mRmlsZSgiL0xpYnJhcnkvUHJlZmVyZW5jZXMvU3lzdGVtQ29uZmlndXJhdGlvbi9jb20uYXBwbGUuc21iLnNlcnZlci5wbGlzdCIpOwoJbGV0IGNvbnRlbnRzID0gT2JqQy5kZWVwVW53cmFwKGRpY3QpOwoJb3V0cHV0WydMb2NhbCBLZXJiZXJvcyBSZWFsbSddID0gY29udGVudHNbJ0xvY2FsS2VyYmVyb3NSZWFsbSddOwoJb3V0cHV0WydORVRCSU9TIE5hbWUnXSA9IGNvbnRlbnRzWydOZXRCSU9TTmFtZSddOwoJb3V0cHV0WydTZXJ2ZXIgRGVzY3JpcHRpb24nXSA9IGNvbnRlbnRzWydTZXJ2ZXJEZXNjcmlwdGlvbiddOwoJaWYoanNvbj09ZmFsc2UpewoJCW91dHB1dCA9ICIqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKlxuIiArICIqKioqKioqIFNNQiBTZXJ2ZXIgUHJlZmVyZW5jZXMgKioqKioqKlxuIiArICIqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKlxuIiArIEpTT04uc3RyaW5naWZ5KG91dHB1dCwgbnVsbCAsIDEpOwoJfWVsc2V7CgkJb3V0cHV0WydIZWFsdGhJbnNwZWN0b3JDb21tYW5kJ10gPSAiU01CX1NlcnZlciI7CgkJb3V0cHV0ID0gSlNPTi5zdHJpbmdpZnkob3V0cHV0LCBudWxsLCAxKTsKCX0KCXJldHVybiBvdXRwdXQ7fQpmdW5jdGlvbiBXaUZpX01lc3NhZ2VzKHtoZWxwPWZhbHNlLCBqc29uPWZhbHNlLCB1c2VyPSIifSA9IHt9KXsKCWlmKGhlbHApewoJICAgIGxldCBvdXRwdXQgPSAiIjsKCQlyZXR1cm4gb3V0cHV0OwoJfQoJbGV0IG91dHB1dCA9IHt9OwoJbGV0IGZpbGVNYW5hZ2VyID0gJC5OU0ZpbGVNYW5hZ2VyLmRlZmF1bHRNYW5hZ2VyOwoJaWYoIWZpbGVfZXhpc3RzKCIvTGlicmFyeS9QcmVmZXJlbmNlcy9TeXN0ZW1Db25maWd1cmF0aW9uL2NvbS5hcHBsZS53aWZpLm1lc3NhZ2UtdHJhY2VyLnBsaXN0IikpewoJCWlmKGpzb249PWZhbHNlKXsKCQkJcmV0dXJuICIqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKlxuIiArICIqKioqKioqKiogV2lGaSBBc3NvY2lhdGlvbnMgKioqKioqKioqXG4iICsgIioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqXG4iICsgIlJlcXVpcmVkIGZpbGUgbm90IGZvdW5kIjsKCQl9ZWxzZXsKCQkJcmV0dXJuIEpTT04uc3RyaW5naWZ5KHsiSGVhbHRoSW5zcGVjdG9yQ29tbWFuZCI6ICJXaUZpX01lc3NhZ2VzIn0pOwoJCX0KCX0KCWxldCBkaWN0ID0gJC5OU011dGFibGVEaWN0aW9uYXJ5LmFsbG9jLmluaXRXaXRoQ29udGVudHNPZkZpbGUoIi9MaWJyYXJ5L1ByZWZlcmVuY2VzL1N5c3RlbUNvbmZpZ3VyYXRpb24vY29tLmFwcGxlLndpZmkubWVzc2FnZS10cmFjZXIucGxpc3QiKTsKCWxldCBjb250ZW50cyA9IE9iakMuZGVlcFVud3JhcChkaWN0KTsKCWlmKGNvbnRlbnRzICE9IHVuZGVmaW5lZCl7CgkJbGV0IGFzc29jaWF0aW9uS2V5cyA9IE9iamVjdC5rZXlzKGNvbnRlbnRzWydBc3NvY2lhdGlvblNTSURNYXAnXSk7CgkJb3V0cHV0WydBc3NvY2lhdGlvbiBTU0lEcyddID0gW107CgkJZm9yKGxldCBpIGluIGFzc29jaWF0aW9uS2V5cyl7CgkJCWxldCBjb25kZW5zZWQgPSBhc3NvY2lhdGlvbktleXNbaV0ucmVwbGFjZSgvIC9nLCAnJyk7CgkJCWNvbmRlbnNlZCA9IGNvbmRlbnNlZC5zdWJzdHJpbmcoMSwgY29uZGVuc2VkLmxlbmd0aC0xKQoJCQlvdXRwdXRbJ0Fzc29jaWF0aW9uIFNTSURzJ10ucHVzaChoZXgyYShjb25kZW5zZWQpKTsKCQl9CgkJYXNzb2NpYXRpb25LZXlzID0gT2JqZWN0LmtleXMoY29udGVudHNbJ0ludGVybmFsQXNzb2NpYXRpb25TU0lETWFwJ10pOwoJCW91dHB1dFsnSW50ZXJuYWxBc3NvY2lhdGlvbiBTU0lEcyddID0gW107CgkJZm9yKGxldCBpIGluIGFzc29jaWF0aW9uS2V5cyl7CgkJCWxldCBjb25kZW5zZWQgPSBhc3NvY2lhdGlvbktleXNbaV0ucmVwbGFjZSgvIC9nLCAnJyk7CgkJCWNvbmRlbnNlZCA9IGNvbmRlbnNlZC5zdWJzdHJpbmcoMSwgY29uZGVuc2VkLmxlbmd0aC0xKQoJCQlvdXRwdXRbJ0ludGVybmFsQXNzb2NpYXRpb24gU1NJRHMnXS5wdXNoKGhleDJhKGNvbmRlbnNlZCkpOwoJCX0KCQlpZihqc29uPT1mYWxzZSl7CgkJCW91dHB1dCA9ICIqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKlxuIiArICIqKioqKioqKiogV2lGaSBBc3NvY2lhdGlvbnMgKioqKioqKioqXG4iICsgIioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqXG4iICsgSlNPTi5zdHJpbmdpZnkob3V0cHV0LCBudWxsICwgMSk7CgkJfWVsc2V7CgkJCW91dHB1dFsnSGVhbHRoSW5zcGVjdG9yQ29tbWFuZCddID0gIldpRmlfTWVzc2FnZXMiOwoJCQlvdXRwdXQgPSBKU09OLnN0cmluZ2lmeShvdXRwdXQsIG51bGwsIDEpOwoJCX0KCQkKCX0KCXJldHVybiBvdXRwdXQ7fQpmdW5jdGlvbiBOZXR3b3JrX0ludGVyZmFjZXMoe2hlbHA9ZmFsc2UsIGpzb249ZmFsc2UsIHVzZXI9IiJ9ID0ge30pewoJaWYoaGVscCl7CgkgICAgbGV0IG91dHB1dCA9ICIiOwoJCXJldHVybiBvdXRwdXQ7Cgl9CglsZXQgb3V0cHV0ID0ge307CglsZXQgZmlsZU1hbmFnZXIgPSAkLk5TRmlsZU1hbmFnZXIuZGVmYXVsdE1hbmFnZXI7CglpZighZmlsZV9leGlzdHMoIi9MaWJyYXJ5L1ByZWZlcmVuY2VzL1N5c3RlbUNvbmZpZ3VyYXRpb24vTmV0d29ya0ludGVyZmFjZXMucGxpc3QiKSl7CgkJaWYoanNvbj09ZmFsc2UpewoJCQlyZXR1cm4gIioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqXG4iICsgIioqKioqKioqKiBOZXR3b3JrIEludGVyZmFjZXMgKioqKioqKioqXG4iICsgIioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqXG4iICsgIlJlcXVpcmVkIGZpbGUgbm90IGZvdW5kIjsKCQl9ZWxzZXsKCQkJcmV0dXJuIEpTT04uc3RyaW5naWZ5KHsiSGVhbHRoSW5zcGVjdG9yQ29tbWFuZCI6ICJOZXR3b3JrX0ludGVyZmFjZXMifSk7CgkJfQoJfQoJbGV0IGRpY3QgPSAkLk5TTXV0YWJsZURpY3Rpb25hcnkuYWxsb2MuaW5pdFdpdGhDb250ZW50c09mRmlsZSgiL0xpYnJhcnkvUHJlZmVyZW5jZXMvU3lzdGVtQ29uZmlndXJhdGlvbi9OZXR3b3JrSW50ZXJmYWNlcy5wbGlzdCIpOwoJbGV0IGNvbnRlbnRzID0gT2JqQy5kZWVwVW53cmFwKGRpY3QpOwoJb3V0cHV0WydOZXR3b3JrIEludGVyZmFjZXMnXSA9IHt9OwoJZm9yKGxldCBpID0gMDsgaSA8IGNvbnRlbnRzWydJbnRlcmZhY2VzJ10ubGVuZ3RoOyBpKyspewoJCW91dHB1dFsnTmV0d29yayBJbnRlcmZhY2VzJ11bY29udGVudHNbJ0ludGVyZmFjZXMnXVtpXVsnQlNEIE5hbWUnXV0gPSB7fTsKCQlvdXRwdXRbJ05ldHdvcmsgSW50ZXJmYWNlcyddW2NvbnRlbnRzWydJbnRlcmZhY2VzJ11baV1bJ0JTRCBOYW1lJ11dWydBY3RpdmUnXSA9IGNvbnRlbnRzWydJbnRlcmZhY2VzJ11baV1bJ0FjdGl2ZSddOwoJCW91dHB1dFsnTmV0d29yayBJbnRlcmZhY2VzJ11bY29udGVudHNbJ0ludGVyZmFjZXMnXVtpXVsnQlNEIE5hbWUnXV1bJ0J1aWx0IEluJ10gPSBjb250ZW50c1snSW50ZXJmYWNlcyddW2ldWydJT0J1aWx0aW4nXTsKCQlvdXRwdXRbJ05ldHdvcmsgSW50ZXJmYWNlcyddW2NvbnRlbnRzWydJbnRlcmZhY2VzJ11baV1bJ0JTRCBOYW1lJ11dWydOZXR3b3JrIFR5cGUnXSA9IGNvbnRlbnRzWydJbnRlcmZhY2VzJ11baV1bJ1NDTmV0d29ya0ludGVyZmFjZVR5cGUnXTsKCQlvdXRwdXRbJ05ldHdvcmsgSW50ZXJmYWNlcyddW2NvbnRlbnRzWydJbnRlcmZhY2VzJ11baV1bJ0JTRCBOYW1lJ11dWydJbmZvJ10gPSBjb250ZW50c1snSW50ZXJmYWNlcyddW2ldWydTQ05ldHdvcmtJbnRlcmZhY2VJbmZvJ107Cgl9CglpZihqc29uPT1mYWxzZSl7CgkJb3V0cHV0ID0gIioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqXG4iICsgIioqKioqKioqKiBOZXR3b3JrIEludGVyZmFjZXMgKioqKioqKioqXG4iICsgIioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqXG4iICsgSlNPTi5zdHJpbmdpZnkob3V0cHV0LCBudWxsICwgMSk7Cgl9ZWxzZXsKCQlvdXRwdXRbJ0hlYWx0aEluc3BlY3RvckNvbW1hbmQnXSA9ICJOZXR3b3JrX0ludGVyZmFjZXMiOwoJCW91dHB1dCA9IEpTT04uc3RyaW5naWZ5KG91dHB1dCwgbnVsbCwgMSk7Cgl9CglyZXR1cm4gb3V0cHV0O30KZnVuY3Rpb24gQmx1ZXRvb3RoX0Nvbm5lY3Rpb25zKHtoZWxwPWZhbHNlLCBqc29uPWZhbHNlLCB1c2VyPSIifSA9IHt9KXsKCWlmKGhlbHApewoJICAgIGxldCBvdXRwdXQgPSAiIjsKCQlyZXR1cm4gb3V0cHV0OwoJfQoJbGV0IG91dHB1dCA9IHt9OwoJbGV0IGZpbGVNYW5hZ2VyID0gJC5OU0ZpbGVNYW5hZ2VyLmRlZmF1bHRNYW5hZ2VyOwoJaWYoIWZpbGVfZXhpc3RzKCIvTGlicmFyeS9QcmVmZXJlbmNlcy9jb20uYXBwbGUuQmx1ZXRvb3RoLnBsaXN0IikpewoJCWlmKGpzb249PWZhbHNlKXsKCQkJcmV0dXJuICIqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKlxuIiArICIqKioqKioqIEJsdWV0b290aCBDb25uZWN0aW9ucyAqKioqKioqXG4iICsgIioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqXG4iICsgIlJlcXVpcmVkIGZpbGUgbm90IGZvdW5kIjsKCQl9ZWxzZXsKCQkJcmV0dXJuIEpTT04uc3RyaW5naWZ5KHsiSGVhbHRoSW5zcGVjdG9yQ29tbWFuZCI6ICJCbHVldG9vdGhfQ29ubmVjdGlvbnMifSk7CgkJfQoJfQoJbGV0IGRpY3QgPSAkLk5TTXV0YWJsZURpY3Rpb25hcnkuYWxsb2MuaW5pdFdpdGhDb250ZW50c09mRmlsZSgiL0xpYnJhcnkvUHJlZmVyZW5jZXMvY29tLmFwcGxlLkJsdWV0b290aC5wbGlzdCIpOwoJbGV0IGNvbnRlbnRzID0gT2JqQy5kZWVwVW53cmFwKGRpY3QpOwoJaWYoY29udGVudHMgIT0gdW5kZWZpbmVkICYmIGNvbnRlbnRzLmhhc093blByb3BlcnR5KCdEZXZpY2VDYWNoZScpKXsKCQlsZXQgQmx1ZXRvb3RoX0tleXMgPSBPYmplY3Qua2V5cyhjb250ZW50c1snRGV2aWNlQ2FjaGUnXSk7CgkJbGV0IHN0cmluZ190b19uYW1lID0ge307CgkJZm9yKGxldCBpIGluIEJsdWV0b290aF9LZXlzKXsKCQkJc3RyaW5nX3RvX25hbWVbQmx1ZXRvb3RoX0tleXNbaV1dID0gY29udGVudHNbJ0RldmljZUNhY2hlJ11bQmx1ZXRvb3RoX0tleXNbaV1dWydOYW1lJ107CgkJfQoJCW91dHB1dFsnRGV2aWNlIENhY2hlJ10gPSBbXTsKCQlmb3IobGV0IGkgaW4gQmx1ZXRvb3RoX0tleXMpewoJCQlsZXQgIENsYXNzT2ZEZXZpY2UgPSB1bmRlZmluZWQ7CgkJCWlmKGNvbnRlbnRzWydEZXZpY2VDYWNoZSddW0JsdWV0b290aF9LZXlzW2ldXS5oYXNPd25Qcm9wZXJ0eSgnQ2xhc3NPZkRldmljZScpKXsKCQkJCUNsYXNzT2ZEZXZpY2UgPSBjb250ZW50c1snRGV2aWNlQ2FjaGUnXVtCbHVldG9vdGhfS2V5c1tpXV1bJ0NsYXNzT2ZEZXZpY2UnXS50b1N0cmluZygxNik7CgkJCX0KCQkJbGV0IGRpc3BsYXlOYW1lID0gY29udGVudHNbJ0RldmljZUNhY2hlJ11bQmx1ZXRvb3RoX0tleXNbaV1dWydkaXNwbGF5TmFtZSddOwoJCQlsZXQgbmFtZSA9IGNvbnRlbnRzWydEZXZpY2VDYWNoZSddW0JsdWV0b290aF9LZXlzW2ldXVsnTmFtZSddOwoJCQlsZXQgbGFzdENvbm5lY3RlZCA9IGNvbnRlbnRzWydEZXZpY2VDYWNoZSddW0JsdWV0b290aF9LZXlzW2ldXVsnTGFzdElucXVpcnlVcGRhdGUnXTsKCQkJbGV0IGxhc3ROYW1lVXBkYXRlID0gY29udGVudHNbJ0RldmljZUNhY2hlJ11bQmx1ZXRvb3RoX0tleXNbaV1dWydMYXN0TmFtZVVwZGF0ZSddOwoJCQlvdXRwdXRbJ0RldmljZSBDYWNoZSddLnB1c2goeyJOYW1lIjogbmFtZSwgIkNsYXNzIG9mIERldmljZSI6IENsYXNzT2ZEZXZpY2UsICJMYXN0IENvbm5lY3RlZCI6IGxhc3RDb25uZWN0ZWQsICJMYXN0IFVwZGF0ZWQiOiBsYXN0TmFtZVVwZGF0ZSwgIkRpc3BsYXkgTmFtZSI6IGRpc3BsYXlOYW1lfSkKCQl9CgkJb3V0cHV0WydDdXJyZW50bHkgUGFpcmVkIERldmljZXMnXSA9IFtdOwoJCWlmKGNvbnRlbnRzLmhhc093blByb3BlcnR5KCdQYWlyZWREZXZpY2VzJykpewoJCQlmb3IobGV0IGkgPSAwOyBpIDwgY29udGVudHNbJ1BhaXJlZERldmljZXMnXS5sZW5ndGg7IGkrKyl7CgkJCQlvdXRwdXRbJ0N1cnJlbnRseSBQYWlyZWQgRGV2aWNlcyddLnB1c2goc3RyaW5nX3RvX25hbWVbY29udGVudHNbJ1BhaXJlZERldmljZXMnXVtpXV0pOwoJCQl9CgkJfQoJfQoJaWYoanNvbj09ZmFsc2UpewoJCW91dHB1dCA9ICIqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKlxuIiArICIqKioqKioqIEJsdWV0b290aCBDb25uZWN0aW9ucyAqKioqKioqXG4iICsgIioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqXG4iICsgIkNvbnZlcnQgQ2xhc3Mgb2YgRGV2aWNlIHdpdGg6IGh0dHA6Ly9kb21vdGljeC5jb20vYmx1ZXRvb3RoLWNsYXNzLW9mLWRldmljZS1saXN0LWNvZC9cbiIgKyBKU09OLnN0cmluZ2lmeShvdXRwdXQsIG51bGwgLCAxKTsKCX1lbHNlewoJCW91dHB1dFsnSGVhbHRoSW5zcGVjdG9yQ29tbWFuZCddID0gIkJsdWV0b290aF9Db25uZWN0aW9ucyI7CgkJb3V0cHV0ID0gSlNPTi5zdHJpbmdpZnkob3V0cHV0LCBudWxsLCAxKTsKCX0JCglyZXR1cm4gb3V0cHV0O30KZnVuY3Rpb24gT1NfVmVyc2lvbih7aGVscD1mYWxzZSwganNvbj1mYWxzZSwgdXNlcj0iIn0gPSB7fSl7CglpZihoZWxwKXsKCSAgICBsZXQgb3V0cHV0ID0gIiI7CgkJcmV0dXJuIG91dHB1dDsKCX0KCWxldCBvdXRwdXQgPSB7fTsKCWxldCBmaWxlTWFuYWdlciA9ICQuTlNGaWxlTWFuYWdlci5kZWZhdWx0TWFuYWdlcjsKCWlmKCFmaWxlX2V4aXN0cygiL1N5c3RlbS9MaWJyYXJ5L0NvcmVTZXJ2aWNlcy9TeXN0ZW1WZXJzaW9uLnBsaXN0IikpewoJCWlmKGpzb249PWZhbHNlKXsKCQkJcmV0dXJuICIqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKlxuIiArICIqKioqKioqKioqIE9TIFZlcnNpb24gSW5mbyAgKioqKioqKioqKlxuIiArICIqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKlxuIiArICJSZXF1aXJlZCBmaWxlIG5vdCBmb3VuZCI7CgkJfWVsc2V7CgkJCXJldHVybiBKU09OLnN0cmluZ2lmeSh7IkhlYWx0aEluc3BlY3RvckNvbW1hbmQiOiAiT1NfVmVyc2lvbiJ9KTsKCQl9Cgl9CglsZXQgZGljdCA9ICQuTlNNdXRhYmxlRGljdGlvbmFyeS5hbGxvYy5pbml0V2l0aENvbnRlbnRzT2ZGaWxlKCIvU3lzdGVtL0xpYnJhcnkvQ29yZVNlcnZpY2VzL1N5c3RlbVZlcnNpb24ucGxpc3QiKTsKCW91dHB1dCA9IE9iakMuZGVlcFVud3JhcChkaWN0KTsKCWRpY3QgPSAkLk5TTXV0YWJsZURpY3Rpb25hcnkuYWxsb2MuaW5pdFdpdGhDb250ZW50c09mRmlsZSgiL0xpYnJhcnkvUHJlZmVyZW5jZXMvY29tLmFwcGxlLlNvZnR3YXJlVXBkYXRlLnBsaXN0Iik7CglvdXRwdXRbJ1NvZnR3YXJlVXBkYXRlJ10gPSBPYmpDLmRlZXBVbndyYXAoZGljdCk7CglpZihqc29uPT1mYWxzZSl7CgkJb3V0cHV0ID0gIioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqXG4iICsgIioqKioqKioqKiogT1MgVmVyc2lvbiBJbmZvICAqKioqKioqKioqXG4iICsgIioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqXG4iICsgSlNPTi5zdHJpbmdpZnkob3V0cHV0LCBudWxsICwgMSk7Cgl9ZWxzZXsKCQlvdXRwdXRbJ0hlYWx0aEluc3BlY3RvckNvbW1hbmQnXSA9ICJPU19WZXJzaW9uIjsKCQlvdXRwdXQgPSBKU09OLnN0cmluZ2lmeShvdXRwdXQsIG51bGwsIDEpOwoJfQoJCglyZXR1cm4gb3V0cHV0O30KZnVuY3Rpb24gS3JiNV9BRF9Db25maWcoe2hlbHA9ZmFsc2UsIGpzb249ZmFsc2UsIHVzZXI9IiJ9KXsKCWlmKGhlbHApewoJICAgIGxldCBvdXRwdXQgPSAiIjsKCQlyZXR1cm4gb3V0cHV0OwoJfQoJbGV0IG91dHB1dCA9IHt9OwoJbGV0IGZpbGVNYW5hZ2VyID0gJC5OU0ZpbGVNYW5hZ2VyLmRlZmF1bHRNYW5hZ2VyOwoJaWYoIWZpbGVfZXhpc3RzKCIvZXRjL2tyYjUuY29uZiIpKXsKCQlpZihqc29uPT1mYWxzZSl7CgkJCXJldHVybiAiKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKipcbiIgKyAiKioqKioqKioqKiBBRCBDb25maWcgICoqKioqKioqKipcbiIgKyAiKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKipcbiIgKyAiUmVxdWlyZWQgZmlsZSBub3QgZm91bmQiOwoJCX1lbHNlewoJCQlyZXR1cm4gSlNPTi5zdHJpbmdpZnkoeyJIZWFsdGhJbnNwZWN0b3JDb21tYW5kIjogIktyYjVfQURfQ29uZmlnIn0pOwoJCX0KCX0KCWxldCBkaWN0ID0gJC5OU1N0cmluZy5hbGxvYy5pbml0V2l0aENvbnRlbnRzT2ZGaWxlRW5jb2RpbmdFcnJvcigiL2V0Yy9rcmI1LmNvbmYiLCAkLk5TVVRGOFN0cmluZ0VuY29kaW5nLCAkKCkpOwoJb3V0cHV0ID0geyJjb25maWciOiBkaWN0fTsKCWlmKGpzb249PWZhbHNlKXsKCQlvdXRwdXQgPSAiKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKipcbiIgKyAiKioqKioqKioqKiBBRCBDb25maWcgICoqKioqKioqKipcbiIgKyAiKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKipcbiIgKyBKU09OLnN0cmluZ2lmeShvdXRwdXQsIG51bGwgLCAxKTsKCX1lbHNlewoJCW91dHB1dFsnSGVhbHRoSW5zcGVjdG9yQ29tbWFuZCddID0gIktyYjVfQURfQ29uZmlnIjsKCQlvdXRwdXQgPSBKU09OLnN0cmluZ2lmeShvdXRwdXQsIG51bGwsIDEpOwoJfQoJCglyZXR1cm4gb3V0cHV0O30KZnVuY3Rpb24gS3JiNV9BRF9Mb2dnaW5nKHtoZWxwPWZhbHNlLCBqc29uPWZhbHNlLCB1c2VyPSIifSA9IHt9KXsKCWlmKGhlbHApewoJICAgIGxldCBvdXRwdXQgPSAiIjsKCQlyZXR1cm4gb3V0cHV0OwoJfQoJbGV0IG91dHB1dCA9IHt9OwoJbGV0IGZpbGVNYW5hZ2VyID0gJC5OU0ZpbGVNYW5hZ2VyLmRlZmF1bHRNYW5hZ2VyOwoJaWYoIWZpbGVfZXhpc3RzKCIvTGlicmFyeS9QcmVmZXJlbmNlcy9jb20uYXBwbGUuS2VyYmVyb3MucGxpc3QiKSl7CgkJaWYoanNvbj09ZmFsc2UpewoJCQlyZXR1cm4gIioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqXG4iICsgIioqKioqKioqKiogS3JiNSBMb2dnaW5nICAqKioqKioqKioqXG4iICsgIioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqXG4iICsgIlJlcXVpcmVkIGZpbGUgbm90IGZvdW5kIjsKCQl9ZWxzZXsKCQkJcmV0dXJuIEpTT04uc3RyaW5naWZ5KHsiSGVhbHRoSW5zcGVjdG9yQ29tbWFuZCI6ICJLcmI1X0FEX0xvZ2dpbmcifSk7CgkJfQoJfQoJbGV0IGRpY3QgPSAkLk5TTXV0YWJsZURpY3Rpb25hcnkuYWxsb2MuaW5pdFdpdGhDb250ZW50c09mRmlsZSgiL0xpYnJhcnkvUHJlZmVyZW5jZXMvY29tLmFwcGxlLktlcmJlcm9zLnBsaXN0Iik7CglvdXRwdXQgPSBPYmpDLmRlZXBVbndyYXAoZGljdCk7CglpZihqc29uPT1mYWxzZSl7CgkJb3V0cHV0ID0gIioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqXG4iICsgIioqKioqKioqKiogS3JiNSBMb2dnaW5nICAqKioqKioqKioqXG4iICsgIioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqXG4iICsgSlNPTi5zdHJpbmdpZnkob3V0cHV0LCBudWxsICwgMSk7Cgl9ZWxzZXsKCQlvdXRwdXRbJ0hlYWx0aEluc3BlY3RvckNvbW1hbmQnXSA9ICJLcmI1X0FEX0xvZ2dpbmciOwoJCW91dHB1dCA9IEpTT04uc3RyaW5naWZ5KG91dHB1dCwgbnVsbCwgMSk7Cgl9CgkKCXJldHVybiBvdXRwdXQ7fQoKZnVuY3Rpb24gUGFsb2FsdG9HbG9iYWxQcm90ZWN0KHtoZWxwPWZhbHNlLCBqc29uPWZhbHNlLCB1c2VyPSIifSA9IHt9KXsKCWlmKGhlbHApewoJCWxldCBvdXRwdXQgPSAiIjsKCQlyZXR1cm4gb3V0cHV0OwogICAgfQoJbGV0IG91dHB1dCA9IHt9OwoJbGV0IGZpbGVNYW5hZ2VyID0gJC5OU0ZpbGVNYW5hZ2VyLmRlZmF1bHRNYW5hZ2VyOwoJaWYoIWZpbGVfZXhpc3RzKCIvTGlicmFyeS9QcmVmZXJlbmNlcy9jb20ucGFsb2FsdG9uZXR3b3Jrcy5HbG9iYWxQcm90ZWN0LnNldHRpbmdzLnBsaXN0IikpewoJCWlmKGpzb249PWZhbHNlKXsKCQkJcmV0dXJuICIqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKlxuIiArICIqKioqKioqKioqIFBhbG9hbHRvR2xvYmFsUHJvdGVjdCBwb3J0YWwgICoqKioqKioqKipcbiIgKyAiKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKipcbiIgKyAiUmVxdWlyZWQgZmlsZSBub3QgZm91bmQiOwoJCX1lbHNlewoJCQlyZXR1cm4gSlNPTi5zdHJpbmdpZnkoeyJIZWFsdGhJbnNwZWN0b3JDb21tYW5kIjogIlBhbG9hbHRvR2xvYmFsUHJvdGVjdCJ9KTsKCQl9Cgl9CglsZXQgZGljdCA9ICQuTlNNdXRhYmxlRGljdGlvbmFyeS5hbGxvYy5pbml0V2l0aENvbnRlbnRzT2ZGaWxlKCIvTGlicmFyeS9QcmVmZXJlbmNlcy9jb20ucGFsb2FsdG9uZXR3b3Jrcy5HbG9iYWxQcm90ZWN0LnNldHRpbmdzLnBsaXN0Iik7CglsZXQgY29udGVudHMgPSBPYmpDLmRlZXBVbndyYXAoZGljdCk7CglvdXRwdXRbJ0dsb2JhbCBQcm90ZWN0IFBvcnRhbCddID0gY29udGVudHNbJ1BhbG8gQWx0byBOZXR3b3JrcyddWydHbG9iYWxQcm90ZWN0J11bJ1BhblNldHVwJ11bJ1BvcnRhbCddOwoJb3V0cHV0WydQcmVsb2dvbiddID0gY29udGVudHNbJ1BhbG8gQWx0byBOZXR3b3JrcyddWydHbG9iYWxQcm90ZWN0J11bJ1BhblNldHVwJ11bJ1ByZWxvZ29uJ107CglpZihqc29uPT1mYWxzZSl7CgkJb3V0cHV0ID0gIioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKipcbiIgKyAiKioqKiogUGFsb2FsdG8gTmV0d29ya3MgR2xvYmFsIFByb3RlY3QgUG9ydGFsICoqKioqXG4iICsgIioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKipcbiIgKyBKU09OLnN0cmluZ2lmeShvdXRwdXQsIG51bGwgLCAxKTsKCX1lbHNlewoJCW91dHB1dFsnSGVhbHRoSW5zcGVjdG9yQ29tbWFuZCddID0gIkNoZWNrX1BhbG9hbHRvR2xvYmFsUHJvdGVjdCI7CgkJb3V0cHV0ID0gSlNPTi5zdHJpbmdpZnkob3V0cHV0LCBudWxsLCAxKTsKCX0KCglyZXR1cm4gb3V0cHV0O30KCmZ1bmN0aW9uIEZvcmNlcG9pbnRfRExQX0luZm9ybWF0aW9uKHtoZWxwPWZhbHNlLCBqc29uPWZhbHNlLCB1c2VyPSIifSA9IHt9KXsKCWlmKGhlbHApewoJCWxldCBvdXRwdXQgPSAiIjsKCQlyZXR1cm4gb3V0cHV0OwoJfQoJbGV0IG91dHB1dCA9IHt9OwoJbGV0IGZpbGVNYW5hZ2VyID0gJC5OU0ZpbGVNYW5hZ2VyLmRlZmF1bHRNYW5hZ2VyOwoJaWYoIWZpbGVfZXhpc3RzKCIvTGlicmFyeS9BcHBsaWNhdGlvbiBTdXBwb3J0L1dlYnNlbnNlIEVuZHBvaW50L0RMUC9ETFBDbGllbnQucGxpc3QiKSl7CgkJaWYoanNvbj09ZmFsc2UpewoJCQlyZXR1cm4gIioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqXG4iICsgIioqKioqKioqKiogRm9yY2Vwb2ludCBETFAgSW5mb3JtYXRpb24gICoqKioqKioqKipcbiIgKyAiKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKipcbiIgKyAiUmVxdWlyZWQgZmlsZSBub3QgZm91bmQiOwoJCX1lbHNlewoJCQlyZXR1cm4gSlNPTi5zdHJpbmdpZnkoeyJIZWFsdGhJbnNwZWN0b3JDb21tYW5kIjogIkZvcmNlcG9pbnRfRExQX0luZm9ybWF0aW9uIn0pOwoJCX0KCX0KCWxldCBkaWN0ID0gJC5OU011dGFibGVEaWN0aW9uYXJ5LmFsbG9jLmluaXRXaXRoQ29udGVudHNPZkZpbGUoIi9MaWJyYXJ5L0FwcGxpY2F0aW9uIFN1cHBvcnQvV2Vic2Vuc2UgRW5kcG9pbnQvRExQL0RMUENsaWVudC5wbGlzdCIpOwoJbGV0IGNvbnRlbnRzID0gT2JqQy5kZWVwVW53cmFwKGRpY3QpOwoJb3V0cHV0WydDb25uZWN0aW9uIGRvbWFpbiBuYW1lJ10gPSBjb250ZW50c1snQ29ubmVjdGlvbiBkb21haW4gbmFtZSddOwoJb3V0cHV0WydDb25uZWN0aW9uIHN0YXR1cyddID0gY29udGVudHNbJ0Nvbm5lY3Rpb24gc3RhdHVzJ107CglvdXRwdXRbJ0Nvbm5lY3Rpb24gdXNlciBuYW1lJ10gPSBjb250ZW50c1snQ29ubmVjdGlvbiB1c2VyIG5hbWUnXTsKCW91dHB1dFsnRGlzY292ZXJ5IHN0YXR1cyddID0gY29udGVudHNbJ0Rpc2NvdmVyeSBzdGF0dXMnXTsKCW91dHB1dFsnRW5kcG9pbnQgcHJvZmlsZSBuYW1lJ10gPSBjb250ZW50c1snRW5kcG9pbnQgcHJvZmlsZSBuYW1lJ107CglvdXRwdXRbJ0VuZHBvaW50IHNpbGVudCBtb2RlJ10gPSBjb250ZW50c1snRW5kcG9pbnQgc2lsZW50IG1vZGUnXTsKCW91dHB1dFsnRW5kcG9pbnQgc3RhdHVzJ10gPSBjb250ZW50c1snRW5kcG9pbnQgc3RhdHVzJ107CglvdXRwdXRbJ0ZpbmdlcnByaW50IHZlcnNpb24nXSA9IGNvbnRlbnRzWydGaW5nZXJwcmludCB2ZXJzaW9uJ107CglvdXRwdXRbJ1BvbGljeSB2ZXJzaW9uJ10gPSBjb250ZW50c1snUG9saWN5IHZlcnNpb24nXTsKCW91dHB1dFsnUHJvZmlsZSB2ZXJzaW9uJ10gPSBjb250ZW50c1snUHJvZmlsZSB2ZXJzaW9uJ107CglvdXRwdXRbJ1JlbW90ZSBieXBhc3MnXSA9IGNvbnRlbnRzWydSZW1vdGUgYnlwYXNzJ107CglpZihqc29uPT1mYWxzZSl7CgkJb3V0cHV0ID0gIioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqXG4iICsgIioqKioqIEZvcmNlcG9pbnQgRExQIEluZm8gKioqKipcbiIgKyAiKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKipcbiIgKyBKU09OLnN0cmluZ2lmeShvdXRwdXQsIG51bGwgLCAxKTsKCX1lbHNlewoJCW91dHB1dFsnSGVhbHRoSW5zcGVjdG9yQ29tbWFuZCddID0gIkZvcmNlcG9pbnRfRExQX0luZm9ybWF0aW9uIjsKCQlvdXRwdXQgPSBKU09OLnN0cmluZ2lmeShvdXRwdXQsIG51bGwsIDEpOwoJfQoKCXJldHVybiBvdXRwdXQ7fQoKZnVuY3Rpb24gQVZFbnVtKCkgewoJT2JqQy5pbXBvcnQoIkFwcEtpdCIpOwoJdmFyIGZpbGVNYW4gPSAkLk5TRmlsZU1hbmFnZXIuZGVmYXVsdE1hbmFnZXI7Cgl2YXIgcnVuYXBwcyA9ICQuTlNXb3Jrc3BhY2Uuc2hhcmVkV29ya3NwYWNlLnJ1bm5pbmdBcHBsaWNhdGlvbnMuanM7Cgl2YXIgYXBwbGlzdCA9IFtdOwoJZm9yKGxldCBpID0gMDsgaSA8IHJ1bmFwcHMubGVuZ3RoOyBpKyspewoJICAgICAgICBsZXQgaW5mbyA9IHt9OwoJICAgICAgICBpbmZvWyduYW1lJ10gPSBydW5hcHBzW2ldLmxvY2FsaXplZE5hbWUuanM7CgkgICAgICAgIGFwcGxpc3QucHVzaChpbmZvWyduYW1lJ10pOwoKCX0KCgl2YXIgb3V0cHV0ID0gIiI7CgoJdmFyIGFsbGFwcHMgPSBhcHBsaXN0LnRvU3RyaW5nKCk7Cgl2YXIgYiA9IDA7CglvdXRwdXQgKz0gIioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqXG4iOwoJb3V0cHV0ICs9ICIqKioqKioqKipTZWN1cml0eSBUb29scyBDaGVjayoqKioqKioqKlxuIjsKCW91dHB1dCArPSAiKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKipcbiI7CglpZiAoKGFsbGFwcHMuaW5jbHVkZXMoIkNiT3N4U2Vuc29yU2VydmljZSIpKSB8fCAoZmlsZU1hbi5maWxlRXhpc3RzQXRQYXRoKCIvQXBwbGljYXRpb25zL0NhcmJvbkJsYWNrL0NiT3N4U2Vuc29yU2VydmljZSIpKSl7CgkgICAgICAgIG91dHB1dCArPSAiWytdIENhcmJvbiBCbGFjayBTZW5zb3IgaW5zdGFsbGVkLlxuIjsKCSAgICAgICAgYiA9IDE7Cgl9CgoJaWYgKChhbGxhcHBzLmluY2x1ZGVzKCJDYkRlZmVuc2UiKSkgfHwgKGZpbGVNYW4uZmlsZUV4aXN0c0F0UGF0aCgiL0FwcGxpY2F0aW9ucy9Db25mZXIuYXBwIikpKXsKCSAgICAgICAgb3V0cHV0ICs9ICJbK10gQ0IgRGVmZW5zZSBBL1YgaW5zdGFsbGVkLlxuIjsKCSAgICAgICAgYiA9IDE7Cgl9CgoJaWYgKChhbGxhcHBzLmluY2x1ZGVzKCJFU0VUIikpIHx8IChhbGxhcHBzLmluY2x1ZGVzKCJlc2V0IikpIHx8IChmaWxlTWFuLmZpbGVFeGlzdHNBdFBhdGgoIkxpYnJhcnkvQXBwbGljYXRpb24gU3VwcG9ydC9jb20uZXNldC5yZW1vdGVhZG1pbmlzdHJhdG9yLmFnZW50IikpKXsKCSAgICAgICAgb3V0cHV0ICs9ICJbK10gRVNFVCBBL1YgaW5zdGFsbGVkLlxuIjsKCSAgICAgICAgYiA9IDE7Cgl9CgoJaWYgKChhbGxhcHBzLmluY2x1ZGVzKCJMaXR0bGVzbml0Y2giKSkgfHwgKGFsbGFwcHMuaW5jbHVkZXMoIlNuaXRjaCIpKSB8fCAoZmlsZU1hbi5maWxlRXhpc3RzQXRQYXRoKCIvTGlicmFyeS9MaXR0bGUgU25pdGNoLyIpKSl7CgkgICAgICAgIG91dHB1dCArPSAiWytdIExpdHRsZXNuaXRjaCBmaXJld2FsbCBmb3VuZC5cbiI7CgkgICAgICAgIGIgPSAxOwoJfQoKCWlmICgoYWxsYXBwcy5pbmNsdWRlcygieGFndCIpKSB8fCAoZmlsZU1hbi5maWxlRXhpc3RzQXRQYXRoKCIvTGlicmFyeS9GaXJlRXllL3hhZ3QiKSkpewoJICAgICAgICBvdXRwdXQgKz0gIlsrXSBGaXJlRXllIEhYIGFnZW50IGZvdW5kLlxuIjsKCSAgICAgICAgYiA9IDE7Cgl9CgoJaWYgKChhbGxhcHBzLmluY2x1ZGVzKCJmYWxjb25jdGwiKSkgfHwgKGZpbGVNYW4uZmlsZUV4aXN0c0F0UGF0aCgiL0xpYnJhcnkvQ1MvZmFsY29uZCIpKSB8fCAoZmlsZU1hbi5maWxlRXhpc3RzQXRQYXRoKCIvQXBwbGljYXRpb25zL0ZhbGNvbi5hcHAiKSkpewoJICAgICAgICBvdXRwdXQgKz0gIlsrXSBDcm93ZHN0cmlrZSBGYWxjb24gYWdlbnQgZm91bmQuXG4iOwoJICAgICAgICBiID0gMTsKCX0KCglpZiAoKGFsbGFwcHMuaW5jbHVkZXMoIk9wZW5ETlMiKSkgfHwgKGFsbGFwcHMuaW5jbHVkZXMoIm9wZW5kbnMiKSkgfHwgKGZpbGVNYW4uZmlsZUV4aXN0c0F0UGF0aCgiL0xpYnJhcnkvQXBwbGljYXRpb24gU3VwcG9ydC9PcGVuRE5TIFJvYW1pbmcgQ2xpZW50L2Rucy11cGRhdGVyIikpKXsKCSAgICAgICAgb3V0cHV0ICs9ICJbK10gT3BlbkROUyBjbGllbnQgZm91bmQuXG4iOwoJICAgICAgICBiID0gMTsKCX0KCglpZiAoKGFsbGFwcHMuaW5jbHVkZXMoIlNlbnRpbmVsT25lIikpIHx8IChhbGxhcHBzLmluY2x1ZGVzKCJzZW50aW5lbG9uZSIpKSl7CgkgICAgICAgIG91dHB1dCArPSAiWytdIFNlbnRpbmVsIE9uZSBhZ2VudCBmb3VuZC5cbiI7CgkgICAgICAgIGIgPSAxOwoJfQoKCWlmICgoYWxsYXBwcy5pbmNsdWRlcygiR2xvYmFsUHJvdGVjdCIpKSB8fCAoYWxsYXBwcy5pbmNsdWRlcygiUGFuR1BTIikpIHx8IChmaWxlTWFuLmZpbGVFeGlzdHNBdFBhdGgoIi9MaWJyYXJ5L0xvZ3MvUGFsb0FsdG9OZXR3b3Jrcy9HbG9iYWxQcm90ZWN0IikpIHx8IChmaWxlTWFuLmZpbGVFeGlzdHNBdFBhdGgoIi9MaWJyYXJ5L1BhbG9BbHRvTmV0d29ya3MiKSkpewoJICAgICAgICBvdXRwdXQgKz0gIlsrXSBHbG9iYWwgUHJvdGVjdCBQQU4gVlBOIGNsaWVudCBmb3VuZC5cbiI7CgkgICAgICAgIGIgPSAxOwoJfQoKCWlmICgoYWxsYXBwcy5pbmNsdWRlcygiSG9zdENoZWNrZXIiKSkgfHwgKGFsbGFwcHMuaW5jbHVkZXMoInB1bHNlc2VjdXJlIikpIHx8IChmaWxlTWFuLmZpbGVFeGlzdHNBdFBhdGgoIi9BcHBsaWNhdGlvbnMvUHVsc2UgU2VjdXJlLmFwcCIpKSB8fCAoYWxsYXBwcy5pbmNsdWRlcygiUHVsc2UtU2VjdXJlIikpKXsKCSAgICAgICAgb3V0cHV0ICs9ICJbK10gUHVsc2UgVlBOIGNsaWVudCBmb3VuZC5cbiI7CgkgICAgICAgIGIgPSAxOwoJfQoKCWlmICgoYWxsYXBwcy5pbmNsdWRlcygiQU1QLWZvci1FbmRwb2ludHMiKSkgfHwgKGZpbGVNYW4uZmlsZUV4aXN0c0F0UGF0aCgiL29wdC9jaXNjby9hbXAiKSkpewoJICAgICAgICBvdXRwdXQgKz0gIlsrXSBDaXNjbyBBTVAgZm9yIGVuZHBvaW50cyBmb3VuZC5cbiI7CgkgICAgICAgIGIgPSAxOwoJfQoKCWlmICgoZmlsZU1hbi5maWxlRXhpc3RzQXRQYXRoKCIvdXNyL2xvY2FsL2Jpbi9qYW1mIikpIHx8IChmaWxlTWFuLmZpbGVFeGlzdHNBdFBhdGgoIi91c3IvbG9jYWwvamFtZiIpKSl7CgkgICAgICAgIG91dHB1dCArPSAiWytdIEpBTUYgZm91bmQgb24gdGhpcyBob3N0LlxuIjsKCSAgICAgICAgYiA9IDE7Cgl9CgoJaWYgKGZpbGVNYW4uZmlsZUV4aXN0c0F0UGF0aCgiL0xpYnJhcnkvQXBwbGljYXRpb24gU3VwcG9ydC9NYWx3YXJlYnl0ZXMiKSl7CgkgICAgICAgIG91dHB1dCArPSAiWytdIE1hbHdhcmVieXRlcyBBL1YgZm91bmQuXG4iOwoJICAgICAgICBiID0gMTsKCX0KCglpZiAoZmlsZU1hbi5maWxlRXhpc3RzQXRQYXRoKCIvdXNyL2xvY2FsL2Jpbi9vc3F1ZXJ5aSIpKXsKCSAgICAgICAgb3V0cHV0ICs9ICJbK10gb3NxdWVyeSBmb3VuZC5cbiI7CgkgICAgICAgIGIgPSAxOwoJfQoKCWlmIChmaWxlTWFuLmZpbGVFeGlzdHNBdFBhdGgoIi9MaWJyYXJ5L1NvcGhvcyBBbnRpLVZpcnVzLyIpKXsKCSAgICAgICAgb3V0cHV0ICs9ICJbK10gU29waG9zIEEvViBmb3VuZC5cbiI7CgkgICAgICAgIGIgPSAxOwoJfQoKCWlmICgoYWxsYXBwcy5pbmNsdWRlcygibHVsdSIpKSB8fCAoZmlsZU1hbi5maWxlRXhpc3RzQXRQYXRoKCIvTGlicmFyeS9PYmplY3RpdmUtU2VlL0x1bHUiKSkgfHwgKGZpbGVNYW4uZmlsZUV4aXN0c0F0UGF0aCgiL0FwcGxpY2F0aW9ucy9MdUx1LmFwcCIpKSl7CgkgICAgICAgIG91dHB1dCArPSAiWytdIEx1THUgZmlyZXdhbGwgZm91bmQuXG4iOwoJICAgICAgICBiID0gMTsKCX0KCglpZiAoKGFsbGFwcHMuaW5jbHVkZXMoImRuZCIpKSB8fCAoZmlsZU1hbi5maWxlRXhpc3RzQXRQYXRoKCIvTGlicmFyeS9PYmplY3RpdmUtU2VlL0RORCIpKSB8fCAoZmlsZU1hbi5maWxlRXhpc3RzQXRQYXRoKCIvQXBwbGljYXRpb25zL0RvIE5vdCBEaXN0dXJiLmFwcC8iKSkpewoJICAgICAgICBvdXRwdXQgKz0gIlsrXSBEbyBOb3QgRGlzdHVyYiAnbGlkIG9wZW4nIGV2ZW50IG1vbml0b3IgZm91bmQuXG4iOwoJICAgICAgICBiID0gMTsKCX0KCglpZiAoKGFsbGFwcHMuaW5jbHVkZXMoIldoYXRzWW91clNpZ24iKSkgfHwgKGZpbGVNYW4uZmlsZUV4aXN0c0F0UGF0aCgiL0FwcGxpY2F0aW9ucy9XaGF0c1lvdXJTaWduLmFwcCIpKSl7CgkgICAgICAgIG91dHB1dCArPSAiWytdIFdoYXRzIFlvdXIgU2lnbiBjb2RlIHNpZ25hdHVyZSBpbmZvIHRvb2wgZm91bmQuXG4iOwoJICAgICAgICBiID0gMTsKCX0KCglpZiAoKGFsbGFwcHMuaW5jbHVkZXMoIktub2NrS25vY2siKSkgfHwgKGZpbGVNYW4uZmlsZUV4aXN0c0F0UGF0aCgiL0FwcGxpY2F0aW9ucy9Lbm9ja0tub2NrLmFwcCIpKSl7CgkgICAgICAgIG91dHB1dCArPSAiWytdIEtub2NrIEtub2NrIHBlcnNpc3RlbmNlIGRldGVjdGlvbiB0b29sIGZvdW5kLlxuIjsKCSAgICAgICAgYiA9IDE7Cgl9CgoJaWYgKChhbGxhcHBzLmluY2x1ZGVzKCJyZWlrZXkiKSkgfHwgKGZpbGVNYW4uZmlsZUV4aXN0c0F0UGF0aCgiL0FwcGxpY2F0aW9ucy9SZWlLZXkuYXBwIikpKXsKCSAgICAgICAgb3V0cHV0ICs9ICJbK10gUmVpS2V5IGtleWJvYXJkIGV2ZW50IHRhcHMgZGV0ZWN0aW9uIHRvb2wgZm91bmQuXG4iOwoJICAgICAgICBiID0gMTsKCX0KCglpZiAoKGFsbGFwcHMuaW5jbHVkZXMoIk92ZXJTaWdodCIpKSB8fCAoZmlsZU1hbi5maWxlRXhpc3RzQXRQYXRoKCIvQXBwbGljYXRpb25zL092ZXJTaWdodC5hcHAiKSkpewoJICAgICAgICBvdXRwdXQgKz0gIlsrXSBPdmVyU2lnaHQgbWljcm9waG9uZSBhbmQgY2FtZXJhIG1vbml0b3JpbmcgdG9vbCBmb3VuZC5cbiI7CgkgICAgICAgIGIgPSAxOwoJfQoKCWlmICgoYWxsYXBwcy5pbmNsdWRlcygiS2V4dFZpZXdyIikpIHx8IChmaWxlTWFuLmZpbGVFeGlzdHNBdFBhdGgoIi9BcHBsaWNhdGlvbnMvS2V4dFZpZXdyLmFwcCIpKSl7CgkgICAgICAgIG91dHB1dCArPSAiWytdIEtleHRWaWV3ciBrZXJuZWwgbW9kdWxlIGRldGVjdGlvbiB0b29sIGZvdW5kLlxuIjsKCSAgICAgICAgYiA9IDE7Cgl9CgoJaWYgKChhbGxhcHBzLmluY2x1ZGVzKCJibG9ja2Jsb2NrIikpIHx8IChmaWxlTWFuLmZpbGVFeGlzdHNBdFBhdGgoIi9BcHBsaWNhdGlvbnMvQmxvY2tCbG9jayBIZWxwZXIuYXBwIikpKXsKCSAgICAgICAgb3V0cHV0ICs9ICJbK10gQmxvY2sgQmxvY2sgcGVyc2lzdGVuY2UgbG9jYXRpb24gbW9uaXRvcmluZyB0b29sIGZvdW5kLlxuIjsKCSAgICAgICAgYiA9IDE7Cgl9CgoJaWYgKChhbGxhcHBzLmluY2x1ZGVzKCJOZXRpcXVldHRlIikpIHx8IChmaWxlTWFuLmZpbGVFeGlzdHNBdFBhdGgoIi9BcHBsaWNhdGlvbnMvTmV0aXF1ZXR0ZS5hcHAiKSkpewoJICAgICAgICBvdXRwdXQgKz0gIlsrXSBOZXRpcXVldHRlIG5ldHdvcmsgbW9uaXRvcmluZyB0b29sIGZvdW5kLlxuIjsKCSAgICAgICAgYiA9IDE7Cgl9CgoJaWYgKChhbGxhcHBzLmluY2x1ZGVzKCJwcm9jZXNzbW9uaXRvciIpKSB8fCAoZmlsZU1hbi5maWxlRXhpc3RzQXRQYXRoKCIvQXBwbGljYXRpb25zL1Byb2Nlc3NNb25pdG9yLmFwcCIpKSl7CgkgICAgICAgIG91dHB1dCArPSAiWytdIE9iamVjdGl2ZSBTZWUgUHJvY2VzcyBNb25pdG9yIHRvb2wgZm91bmQuXG4iOwoJICAgICAgICBiID0gMTsKCX0KCglpZiAoKGFsbGFwcHMuaW5jbHVkZXMoImZpbGVtb25pdG9yIikpIHx8IChmaWxlTWFuLmZpbGVFeGlzdHNBdFBhdGgoIi9BcHBsaWNhdGlvbnMvRmlsZU1vbml0b3IuYXBwIikpKXsKCSAgICAgICAgb3V0cHV0ICs9ICJbK10gT2JqZWN0aXZlIFNlZSBGaWxlIE1vbml0b3IgdG9vbCBmb3VuZC5cbiI7CgkgICAgICAgIGIgPSAxOwoJfQoKCWlmIChiID09IDApewoJICAgICAgICBvdXRwdXQgKz0gIlstXSBObyBzZWN1cml0eSBwcm9kdWN0cyBmb3VuZC4iOwoJfQoKCW91dHB1dCArPSAiKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKipcbiI7CglyZXR1cm4gb3V0cHV0Owp9CgoKLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KZnVuY3Rpb24gQWxsX0NoZWNrcyh7aGVscD1mYWxzZSwganNvbj1mYWxzZSwgdXNlcj0iIn0gPSB7fSl7CglsZXQgb3V0cHV0ID0gIiI7CglsZXQgaW5wdXRfcGFyYW1ldGVyID0geyJoZWxwIjpoZWxwLCAianNvbiI6anNvbiwgInVzZXIiOiB1c2VyfTsKCW91dHB1dCArPSAiXG4iICsgUGVyc2lzdGVudF9Eb2NrX0FwcHMoaW5wdXRfcGFyYW1ldGVyKTsKCW91dHB1dCArPSAiXG4iICsgU3BhY2VzX0NoZWNrKGlucHV0X3BhcmFtZXRlcik7CglvdXRwdXQgKz0gIlxuIiArIEdldF9PZmZpY2VfRW1haWwoaW5wdXRfcGFyYW1ldGVyKTsKCW91dHB1dCArPSAiXG4iICsgU2F2ZWRfUHJpbnRlcnMoaW5wdXRfcGFyYW1ldGVyKTsKCW91dHB1dCArPSAiXG4iICsgRmluZGVyX1ByZWZlcmVuY2VzKGlucHV0X3BhcmFtZXRlcik7CglvdXRwdXQgKz0gIlxuIiArIExhdW5jaF9TZXJ2aWNlcyhpbnB1dF9wYXJhbWV0ZXIpOwoJb3V0cHV0ICs9ICJcbiIgKyBVbml2ZXJzYWxfQWNjZXNzX0F1dGhfV2FybmluZyhpbnB1dF9wYXJhbWV0ZXIpOwoJb3V0cHV0ICs9ICJcbiIgKyBSZWxhdW5jaF9BdF9Mb2dpbihpbnB1dF9wYXJhbWV0ZXIpOwoJb3V0cHV0ICs9ICJcbiIgKyBMb2dpbl9JdGVtcyhpbnB1dF9wYXJhbWV0ZXIpOwoJb3V0cHV0ICs9ICJcbiIgKyBVc2VyX0Rpcl9IaWRkZW5fRmlsZXNfRm9sZGVycyhpbnB1dF9wYXJhbWV0ZXIpOwoJb3V0cHV0ICs9ICJcbiIgKyBVc2VyX0dsb2JhbF9QcmVmZXJlbmNlcyhpbnB1dF9wYXJhbWV0ZXIpOwoJb3V0cHV0ICs9ICJcbiIgKyBVc2VyX0xhdW5jaGFnZW50cyhpbnB1dF9wYXJhbWV0ZXIpOwoJb3V0cHV0ICs9ICJcbiIgKyBVc2VyX0xhdW5jaGRhZW1vbnMoaW5wdXRfcGFyYW1ldGVyKTsKCW91dHB1dCArPSAiXG4iICsgU3lzdGVtX0xhdW5jaGRhZW1vbnMoaW5wdXRfcGFyYW1ldGVyKTsKCW91dHB1dCArPSAiXG4iICsgSW5zdGFsbGVkX1NvZnR3YXJlX1ZlcnNpb25zKGlucHV0X3BhcmFtZXRlcik7CglvdXRwdXQgKz0gIlxuIiArIFVuaXF1ZV9CYXNoX0hpc3RvcnlfU2Vzc2lvbnMoaW5wdXRfcGFyYW1ldGVyKTsKCW91dHB1dCArPSAiXG4iICsgU1NIX0tleXMoaW5wdXRfcGFyYW1ldGVyKTsKCW91dHB1dCArPSAiXG4iICsgU2xhY2tfRG93bmxvYWRfQ2FjaGVfSGlzdG9yeShpbnB1dF9wYXJhbWV0ZXIpOwoJb3V0cHV0ICs9ICJcbiIgKyBTbGFja19UZWFtX0luZm9ybWF0aW9uKGlucHV0X3BhcmFtZXRlcik7CglvdXRwdXQgKz0gIlxuIiArIFJlY2VudF9GaWxlcyhpbnB1dF9wYXJhbWV0ZXIpOwoJb3V0cHV0ICs9ICJcbiIgKyBGaXJld2FsbChpbnB1dF9wYXJhbWV0ZXIpOwoJb3V0cHV0ICs9ICJcbiIgKyBBaXJwb3J0X1ByZWZlcmVuY2VzKGlucHV0X3BhcmFtZXRlcik7CglvdXRwdXQgKz0gIlxuIiArIFNNQl9TZXJ2ZXIoaW5wdXRfcGFyYW1ldGVyKTsKCW91dHB1dCArPSAiXG4iICsgV2lGaV9NZXNzYWdlcyhpbnB1dF9wYXJhbWV0ZXIpOwoJb3V0cHV0ICs9ICJcbiIgKyBOZXR3b3JrX0ludGVyZmFjZXMoaW5wdXRfcGFyYW1ldGVyKTsKCW91dHB1dCArPSAiXG4iICsgQmx1ZXRvb3RoX0Nvbm5lY3Rpb25zKGlucHV0X3BhcmFtZXRlcik7CglvdXRwdXQgKz0gIlxuIiArIE9TX1ZlcnNpb24oaW5wdXRfcGFyYW1ldGVyKTsKCW91dHB1dCArPSAiXG4iICsgS3JiNV9BRF9Db25maWcoaW5wdXRfcGFyYW1ldGVyKTsKCW91dHB1dCArPSAiXG4iICsgS3JiNV9BRF9Mb2dnaW5nKGlucHV0X3BhcmFtZXRlcik7CglvdXRwdXQgKz0gIlxuIiArIFBhbG9hbHRvR2xvYmFsUHJvdGVjdChpbnB1dF9wYXJhbWV0ZXIpOwoJb3V0cHV0ICs9ICJcbiIgKyBGb3JjZXBvaW50X0RMUF9JbmZvcm1hdGlvbihpbnB1dF9wYXJhbWV0ZXIpOwoJb3V0cHV0ICs9ICJcbiIgKyBBVkVudW0oKTsKCXJldHVybiBvdXRwdXQ7Cn0KZnVuY3Rpb24gVXNlcl9QcmVmZXJlbmNlcyh7aGVscD1mYWxzZSwganNvbj1mYWxzZSwgdXNlcj0iIn0gPSB7fSl7CglsZXQgb3V0cHV0ID0gIiI7CglsZXQgaW5wdXRfcGFyYW1ldGVycyA9IHsiaGVscCI6aGVscCwgImpzb24iOmpzb24sICJ1c2VyIjogdXNlcn07CglvdXRwdXQgKz0gIlxuIiArIFBlcnNpc3RlbnRfRG9ja19BcHBzKGlucHV0X3BhcmFtZXRlcnMpOwoJb3V0cHV0ICs9ICJcbiIgKyBTcGFjZXNfQ2hlY2soaW5wdXRfcGFyYW1ldGVycyk7CglvdXRwdXQgKz0gIlxuIiArIEdldF9PZmZpY2VfRW1haWwoaW5wdXRfcGFyYW1ldGVycyk7CglvdXRwdXQgKz0gIlxuIiArIFNhdmVkX1ByaW50ZXJzKGlucHV0X3BhcmFtZXRlcnMpOwoJb3V0cHV0ICs9ICJcbiIgKyBGaW5kZXJfUHJlZmVyZW5jZXMoaW5wdXRfcGFyYW1ldGVycyk7CglvdXRwdXQgKz0gIlxuIiArIExhdW5jaF9TZXJ2aWNlcyhpbnB1dF9wYXJhbWV0ZXJzKTsKCW91dHB1dCArPSAiXG4iICsgVW5pdmVyc2FsX0FjY2Vzc19BdXRoX1dhcm5pbmcoaW5wdXRfcGFyYW1ldGVycyk7CglvdXRwdXQgKz0gIlxuIiArIFJlbGF1bmNoX0F0X0xvZ2luKGlucHV0X3BhcmFtZXRlcnMpOwoJb3V0cHV0ICs9ICJcbiIgKyBHbG9iYWxfUHJlZmVyZW5jZXMoaW5wdXRfcGFyYW1ldGVycyk7CglvdXRwdXQgKz0gIlxuIiArIE9TX1ZlcnNpb24oaW5wdXRfcGFyYW1ldGVycyk7CglvdXRwdXQgKz0gIlxuIiArIEluc3RhbGxlZF9Tb2Z0d2FyZV9WZXJzaW9ucyhpbnB1dF9wYXJhbWV0ZXJzKTsKCW91dHB1dCArPSAiXG4iICsgVXNlcl9MYXVuY2hhZ2VudHMoaW5wdXRfcGFyYW1ldGVycyk7CglvdXRwdXQgKz0gIlxuIiArIFVzZXJfTGF1bmNoZGFlbW9ucyhpbnB1dF9wYXJhbWV0ZXJzKTsKCW91dHB1dCArPSAiXG4iICsgU2xhY2tfRG93bmxvYWRfQ2FjaGVfSGlzdG9yeShpbnB1dF9wYXJhbWV0ZXJzKTsKCW91dHB1dCArPSAiXG4iICsgU2xhY2tfVGVhbV9JbmZvcm1hdGlvbihpbnB1dF9wYXJhbWV0ZXJzKTsKCXJldHVybiBvdXRwdXQ7Cn0KZnVuY3Rpb24gR2xvYmFsX1ByZWZlcmVuY2VzKHtoZWxwPWZhbHNlLCBqc29uPWZhbHNlLCB1c2VyPSIifSA9IHt9KXsKCWxldCBvdXRwdXQgPSAiIjsKCWxldCBpbnB1dF9wYXJhbWV0ZXJzID0geyJoZWxwIjpoZWxwLCAianNvbiI6anNvbiwgInVzZXIiOiB1c2VyfTsKCW91dHB1dCArPSAiXG4iICsgRmlyZXdhbGwoaW5wdXRfcGFyYW1ldGVycyk7CglvdXRwdXQgKz0gIlxuIiArIEFpcnBvcnRfUHJlZmVyZW5jZXMoaW5wdXRfcGFyYW1ldGVycyk7CglvdXRwdXQgKz0gIlxuIiArIFNNQl9TZXJ2ZXIoaW5wdXRfcGFyYW1ldGVycyk7CglvdXRwdXQgKz0gIlxuIiArIFdpRmlfTWVzc2FnZXMoaW5wdXRfcGFyYW1ldGVycyk7CglvdXRwdXQgKz0gIlxuIiArIE5ldHdvcmtfSW50ZXJmYWNlcyhpbnB1dF9wYXJhbWV0ZXJzKTsKCW91dHB1dCArPSAiXG4iICsgQmx1ZXRvb3RoX0Nvbm5lY3Rpb25zKGlucHV0X3BhcmFtZXRlcnMpOwoJb3V0cHV0ICs9ICJcbiIgKyBLcmI1X0FEX0NvbmZpZyhpbnB1dF9wYXJhbWV0ZXJzKTsKCW91dHB1dCArPSAiXG4iICsgS3JiNV9BRF9Mb2dnaW5nKGlucHV0X3BhcmFtZXRlcnMpOwoJb3V0cHV0ICs9ICJcbiIgKyBQYWxvYWx0b0dsb2JhbFByb3RlY3QoaW5wdXRfcGFyYW1ldGVycyk7CglvdXRwdXQgKz0gIlxuIiArIEZvcmNlcG9pbnRfRExQX0luZm9ybWF0aW9uKGlucHV0X3BhcmFtZXRlcnMpOwoJcmV0dXJuIG91dHB1dDsKfQpBbGxfQ2hlY2tzKCk7"""
    try:
        args = ["osascript","-l","JavaScript","-e",base64.b64decode(encoded)]
        process = run(args,stdout=PIPE,stderr=STDOUT,text=True,errors="ignore")
        data = process.stdout
        vprint(data)
    except Exception as e:
        vprint(f"Error: Exception Raised: {e}")
        

def main():
    global result
    result = []
    runHealthInspector()
    return result

if __name__ == "__main__":
    main()